
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="./theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">


  <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="./images/favicon.ico" type="image/x-icon">










 

<meta name="author" content="Walter Fan" />
<meta name="description" content="Daily minute" />
<meta name="keywords" content="journal, blog">


  <meta property="og:site_name" content="Walter Fan's Blog"/>
  <meta property="og:title" content="AI 把字幕组的活都干了"/>
  <meta property="og:description" content="Daily minute"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./ai-ba-zi-mu-zu-de-huo-du-gan-liao.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2025-01-12 10:20:00+08:00"/>
  <meta property="article:modified_time" content="2025-01-12 19:30:00+08:00"/>
  <meta property="article:author" content="./author/walter-fan.html">
  <meta property="article:section" content="Journal"/>
  <meta property="article:tag" content="journal"/>
  <meta property="article:tag" content="blog"/>
  <meta property="og:image" content="./images/walterfan.jpg">

  <title>Walter Fan's Blog &ndash; AI 把字幕组的活都干了</title>


</head>
<body class="light-theme">

<aside>
  <div>
    <a href="./">
      <img src="./images/walterfan.jpg" alt="Walter Fan" title="Walter Fan">
    </a>

    <h1>
      <a href="./">Walter Fan</a>
    </h1>

    <p>手握灵珠常奋笔, 心开天籁不吹箫</p>


    <nav>
      <ul class="list">



          <li>
            <a target="_self" href="/tao" >tao</a>
          </li>
          <li>
            <a target="_self" href="interest.html" >interest</a>
          </li>
          <li>
            <a target="_self" href="/wordpress" >notebook</a>
          </li>
          <li>
            <a target="_self" href="bookmark.html" >bookmark</a>
          </li>
          <li>
            <a target="_self" href="/webrtc/examples/index.html" >webrtc</a>
          </li>
          <li>
            <a target="_self" href="https://github.com/walterfan" >github</a>
          </li>
          <li>
            <a target="_self" href="https://www.jianshu.com/u/e0b365801f48" >技术文章</a>
          </li>
          <li>
            <a target="_self" href="/tao/tech" >技术笔记</a>
          </li>
          <li>
            <a target="_self" href="/tao/tool" >我的工具</a>
          </li>
          <li>
            <a target="_self" href="/tao" >给我留言</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="http://github.com/walterfan"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-weibo"
           href="http://weibo.com/walterfan"
           target="_blank">
          <i class="fa-brands fa-weibo"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="ai-ba-zi-mu-zu-de-huo-du-gan-liao">AI 把字幕组的活都干了</h1>
    <p>
      Posted on Sun 12 January 2025 in <a href="./category/journal.html">Journal</a>

    </p>
  </header>


  <div>
    <table>
<thead>
<tr>
<th><strong>Abstract</strong></th>
<th>AI 把字幕组的活都干了</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Authors</strong></td>
<td><a href="https://www.fanyamin.com" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="Walter Fan">Walter Fan</a></td>
</tr>
<tr>
<td> <strong>Category</strong>  </td>
<td> learning note  </td>
</tr>
<tr>
<td><strong>Status</strong></td>
<td>v1.0</td>
</tr>
<tr>
<td><strong>Updated</strong></td>
<td>2025-01-12</td>
</tr>
<tr>
<td><strong>License</strong></td>
<td><a href="http://creativecommons.org/licenses/by-nc-nd/4.0" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="CC-BY-NC-ND 4.0">CC-BY-NC-ND 4.0</a></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="#详细步骤" title="详细步骤">详细步骤</a></li>
<li><a href="#第一步将mp4文件的语音提取为-wave-文件" title="第一步：将mp4文件的语音提取为 wave 文件"><strong>第一步</strong>：将mp4文件的语音提取为 wave 文件</a></li>
<li><a href="#第二步调用-whisper-识别语音为文本" title="第二步：调用 whisper 识别语音为文本。"><strong>第二步</strong>：调用 whisper 识别语音为文本。</a></li>
<li><a href="#第三步调用google-translate把文本翻译成中文" title="第三步：调用Google Translate把文本翻译成中文。"><strong>第三步</strong>：调用Google Translate把文本翻译成中文。</a></li>
<li><a href="#第四步将文本转换为字幕文件srt格式" title="第四步：将文本转换为字幕文件srt格式。"><strong>第四步</strong>：将文本转换为字幕文件srt格式。</a></li>
<li><a href="#第五步播放原本的mp4文件并载入生成的字幕文件" title="第五步：播放原本的mp4文件，并载入生成的字幕文件。"><strong>第五步</strong>：播放原本的mp4文件，并载入生成的字幕文件。</a></li>
<li><a href="#具体用法" title="具体用法">具体用法</a></li>
<li><a href="#前提条件" title="前提条件">前提条件</a></li>
<li><a href="#使用方法" title="使用方法">使用方法</a></li>
<li><a href="#小技巧" title="小技巧">小技巧</a></li>
</ul>
<p>最近我在看一个外国同事录的Demo视频呀，那里面有几段他说得那叫一个快，我听了好几遍都没听明白。这可咋办呢？
我灵机一动，想着自己写个脚本吧，把语音转换成文本，然后再把文本从英文翻译成中文，这样不就清楚啦。</p>
<p>说干就干，有了 AI 的加持, 没花多长时间就写好了一段小程序，你别说，效果还不错。
后来我一琢磨，哎呀，我这方法好像把字幕组的活儿都给干了呀，难道以后字幕组都可以解散咯？
虽然只是句玩笑话, 不过说真的，时代的洪流不服不行，好多职业都在这股洪流中“灰飞烟灭”了。</p>
<p>想当年，字幕组给少年时期的我带来了好多欢乐。那时候我就想着，要是我能苦练英语，以后成为一名光荣的字幕组成员。</p>
<p>没想到现在我成了程序员，居然写个小程序就能把字幕组的活儿给干了，这世界变化真快，就像歌里唱的“不是我不明白，这世界变化快”。</p>
<p>在人工智能蓬勃发展的时代，好多岗位都面临着被取代的风险呀，我们程序员也不例外, 令人唏嘘的是，程序员自己写程序把自己的职位给搞没了.
虽然说程序员不会都失业，毕竟人工智能也是要靠我们程序员来实现，但以后确实也不需要那么多程序员了。君不见，多少公司都在搞“裁员广进”，
就连宇宙大厂微软最近也都传出了裁员的消息呢。我自己也是前两年刚从大厂被裁员出来的，说起来都是一把辛酸泪呀。</p>
<p>好啦，废话不多说，咱们来看看这个小程序是怎么把字幕组的活儿都干了的吧。</p>
<h2 id="_1">详细步骤</h2>
<h3 id="mp4-wave"><strong>第一步</strong>：将mp4文件的语音提取为 wave 文件</h3>
<p>将视频文件转换成音频文件，让它变成我们更容易处理的格式。对应的代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extract_audio_from_video</span><span class="p">(</span><span class="n">mp4_file</span><span class="p">,</span> <span class="n">audio_file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract audio from an MP4 file and save as WAV.&quot;&quot;&quot;</span>
    <span class="n">ffmpeg</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">mp4_file</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">audio_file</span><span class="p">)</span><span class="o">.</span><span class="n">global_args</span><span class="p">(</span><span class="s1">&#39;-loglevel&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">audio_file</span>
</code></pre></div>

<p>在命令行中使用时，相关操作示例（假设你已经安装好ffmpeg）：无单独命令行，它是被程序内部调用的哦，你只需要提供正确的mp4文件路径，程序就会自动处理并生成对应的wave文件。</p>
<h3 id="whisper"><strong>第二步</strong>：调用 whisper 识别语音为文本。</h3>
<p>这个whisper就厉害, openai 出口, 必属精品, 可以把视频里的语音识别成文字呢。代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">transcribe_audio_with_whisper</span><span class="p">(</span><span class="n">audio_file</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transcribe audio to text using Whisper.&quot;&quot;&quot;</span>
    <span class="c1"># Load Whisper model</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">whisper</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

    <span class="c1"># Transcribe audio</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transcribe</span><span class="p">(</span><span class="n">audio_file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
</code></pre></div>

<p>同样，这部分也是程序内部调用，没有直接面向用户的命令行操作，但你可以了解到它是如何加载模型并进行语音转文字的核心逻辑。
为了制作字幕文件, 我们最好按段落识别, 并记录段落的赶止时间, 代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">transcribe_audio_with_segments</span><span class="p">(</span><span class="n">audio_file</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">,</span> <span class="n">pause_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">whisper</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transcribe</span><span class="p">(</span><span class="n">audio_file</span><span class="p">,</span> <span class="n">word_timestamps</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">segments</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;segments&quot;</span><span class="p">]</span>
    <span class="n">sn</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">paragraphs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_paragraph</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">previous_end_time</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">paragraph_start_time</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># the first paragraph</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_paragraph</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">paragraph_start_time</span> <span class="o">=</span> <span class="n">start_time</span>

        <span class="c1"># create new paragraph if time distance is greater than pause threshold</span>
        <span class="k">if</span> <span class="n">start_time</span> <span class="o">-</span> <span class="n">previous_end_time</span> <span class="o">&gt;</span> <span class="n">pause_threshold</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">current_paragraph</span><span class="p">:</span>
                <span class="n">sn</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">merged_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_paragraph</span><span class="p">)</span>
                <span class="n">paragraphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">sn</span><span class="si">}</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">format_time</span><span class="p">(</span><span class="n">paragraph_start_time</span><span class="p">)</span><span class="si">}</span><span class="s2"> --&gt; </span><span class="si">{</span><span class="n">format_time</span><span class="p">(</span><span class="n">end_time</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="si">{</span><span class="n">merged_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="c1"># start new paragraph</span>
                <span class="n">current_paragraph</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">paragraph_start_time</span> <span class="o">=</span> <span class="n">start_time</span>

        <span class="n">current_paragraph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">previous_end_time</span> <span class="o">=</span> <span class="n">end_time</span>

    <span class="c1"># the last paragraph</span>
    <span class="k">if</span> <span class="n">current_paragraph</span><span class="p">:</span>
        <span class="n">paragraphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_paragraph</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">paragraphs</span>
</code></pre></div>

<h3 id="google-translate"><strong>第三步</strong>：调用Google Translate把文本翻译成中文。</h3>
<p>-
借助 google translator 这个强大的翻译工具，英文文本能轻松翻译成中文啦。代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">translate_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Translate text from English to Chinese.&quot;&quot;&quot;</span>
    <span class="n">translator</span> <span class="o">=</span> <span class="n">Translator</span><span class="p">()</span>
    <span class="n">translated</span> <span class="o">=</span> <span class="k">await</span> <span class="n">translator</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">dest</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">translated</span><span class="o">.</span><span class="n">text</span>

<span class="k">def</span> <span class="nf">do_translate</span><span class="p">(</span><span class="n">text_file</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
    <span class="n">translated_text</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">translate_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">))</span>
    <span class="n">dest_file_name</span> <span class="o">=</span> <span class="n">text_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dest_file_name</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">translated_text</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;### Transcribed Text:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">translated_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p>它利用<code>googletrans</code>库的<code>Translator</code>类来实现异步翻译，将源语言文本转换成目标语言文本。</p>
<h3 id="srt"><strong>第四步</strong>：将文本转换为字幕文件srt格式。</h3>
<p>代码中虽然没有单独一个函数明确叫“转换为srt格式”，但实际上整个流程最终生成的文本文件（如果指定格式为<code>srt</code>）就是按照字幕文件格式要求来组织内容的，关键在于<code>transcribe_audio_with_segments</code>函数中对段落、时间戳等信息的处理，生成符合字幕格式规范的文本段落，比如:</p>
<div class="highlight"><pre><span></span><code><span class="n">paragraphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">sn</span><span class="si">}</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">format_time</span><span class="p">(</span><span class="n">paragraph_start_time</span><span class="p">)</span><span class="si">}</span><span class="s2"> --&gt; </span><span class="si">{</span><span class="n">format_time</span><span class="p">(</span><span class="n">end_time</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="si">{</span><span class="n">merged_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p>这里<code>format_time</code>函数用来格式化时间戳：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">format_time</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    <span class="n">millis</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">seconds</span><span class="p">))</span>
    <span class="n">mins</span><span class="p">,</span> <span class="n">secs</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">hrs</span><span class="p">,</span> <span class="n">mins</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">mins</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hrs</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">mins</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">secs</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">millis</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>

<h3 id="mp4"><strong>第五步</strong>：播放原本的mp4文件，并载入生成的字幕文件。</h3>
<p>如此这般, 我们就能看着带有中文字幕的视频啦。这一步通常是在视频播放软件中操作，比如常见的VLC播放器，你在播放mp4文件时，在播放器界面找到加载字幕的选项，然后选择我们程序生成的<code>srt</code>字幕文件即可。不同播放器操作略有不同，但大致思路一样。</p>
<h2 id="_2">具体用法</h2>
<p>具体的用法可以参见<a href="https://github.com/walterfan/video_to_text/edit/master/README.md" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="https://github.com/walterfan/video_to_text/edit/master/README.md">https://github.com/walterfan/video_to_text/edit/master/README.md</a> 。</p>
<p>这个脚本是用Python写的，它可以把mp4视频通过 whisper 转换成文本，并且还能把文本从默认的源语言“en”翻译成默认的目标语言“zh-cn”, 最后生成字幕文件。</p>
<h3 id="_3">前提条件</h3>
<p>首先，你得安装ffmpeg和一些必要的库。</p>
<p>在Mac上可以用</p>
<div class="highlight"><pre><span></span><code>brew<span class="w"> </span>install<span class="w"> </span>ffmpeg
</code></pre></div>

<p>来安装ffmpeg，然后用</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div>

<p>来安装其他需要的库。</p>
<h3 id="_4">使用方法</h3>
<p>安装好之后呢，就可以使用啦。在命令行里输入</p>
<div class="highlight"><pre><span></span><code>./video_to_text.py<span class="w"> </span>-h
</code></pre></div>

<p>就能看到具体的使用说明咯, 有如下参数可以设置:</p>
<ul>
<li>--input INPUT: 也就是你要输入的mp4文件的路径；</li>
<li>--output OUTPUT”: 这是输出的文本文件的路径，如果不指定的话，就会和输入文件同名，但是扩展名是“.srt”哦；</li>
<li>--model MODEL: whisper 使用的模型，默认是“small”；</li>
<li>--src SRC: 源语言，默认是“en”, 即英文</li>
<li>--dest DEST: 目标语言, 默认是“zh-cn”, 即中文</li>
<li>--format FORMAT: 输出格式，目前只支持“txt”和“srt”格式哟。</li>
</ul>
<p>例如，你可以输入如下命令来生成视频的一个对应的字幕文件</p>
<div class="highlight"><pre><span></span><code>./video_to_text.py<span class="w"> </span>-i./example/5_minutes_for_50_years.mp4
</code></pre></div>

<p>对应的完整代码可以参见<a href="https://github.com/walterfan/video_to_text/blob/master/video_to_text.py" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="https://github.com/walterfan/video_to_text/blob/master/video_to_text.py">https://github.com/walterfan/video_to_text/blob/master/video_to_text.py</a> 。</p>
<h3 id="_5">小技巧</h3>
<p>另外，还有几个小技巧:</p>
<ul>
<li>你可以从YouTube或其他网站上下载任何你想要的视频，然后用这个脚本来制作字幕哦。</li>
</ul>
<p>比如说，你可以用<a href="https://cobalt.tools/" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="https://cobalt.tools/">https://cobalt.tools/</a> 这个网站来下载视频。</p>
<ul>
<li>下载好之后呢，还可以对视频进行一些处理。比如说用如下命令来裁剪视频</li>
</ul>
<div class="highlight"><pre><span></span><code>ffmpeg<span class="w"> </span>-i<span class="w"> </span>input.mp4<span class="w"> </span>-ss<span class="w"> </span><span class="m">00</span>:00:07<span class="w"> </span>-c:v<span class="w"> </span>copy<span class="w"> </span>-c:a<span class="w"> </span>copy<span class="w"> </span>output_trimmed.mp4
</code></pre></div>

<ul>
<li>或者用如下命令来转换视频的尺寸和码率</li>
</ul>
<div class="highlight"><pre><span></span><code>ffmpeg<span class="w"> </span>-i<span class="w"> </span>output_trimmed.mp4<span class="w"> </span>-vf<span class="w"> </span><span class="nv">scale</span><span class="o">=</span><span class="m">320</span>:180<span class="w"> </span>-c:v<span class="w"> </span>libx264<span class="w"> </span>-preset<span class="w"> </span>fast<span class="w"> </span>-crf<span class="w"> </span><span class="m">23</span><span class="w"> </span>-c:a<span class="w"> </span>aac<span class="w"> </span>-b:a<span class="w"> </span>192k<span class="w"> </span>output_180p.mp4
</code></pre></div>

<p>具体的代码可以参见<a href="https://github.com/walterfan/video_to_text/blob/master/video_to_text.py" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="https://github.com/walterfan/video_to_text/blob/master/video_to_text.py">https://github.com/walterfan/video_to_text/blob/master/video_to_text.py</a> 。怎么样，是不是很有趣呀，大家也赶紧去试试吧。</p>
<hr>
<p>希望以上内容你能喜欢，你可以根据实际情况进行调整和修改, 并回馈到我的代码库, 让更多人受益。如果你还有其他问题，欢迎随时问我, 我会尽力回答。</p>
<hr/>
<p>本作品采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" referrerpolicy="no-referrer" rel="noopener noreferrer" target="_blank" title="知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可。</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/journal.html">journal</a>
      <a href="./tag/blog.html">blog</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="./jmpp-rang-xmpp-xie-yi-lao-shu-kai-xin-hua.html" title="JMPP 让 XMPP 协议老树开新花">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="./jmpp-rang-xmpp-xie-yi-lao-shu-kai-xin-hua.html">JMPP 让 XMPP 协议老树开新花</a></li>
      <li><a href="./bie-liao-2024ni-hao-2025.html">别了2024，你好2025</a></li>
      <li><a href="./cheng-xu-yuan-hui-bu-hui-bei-ai-qu-dai.html">程序员会不会被 AI 取代</a></li>
      <li><a href="./wo-zai-chuang-ye-gong-si-zhe-yi-nian.html">我在创业公司这一年</a></li>
      <li><a href="./shen-suo-de-yi-zhu.html">伸缩的艺术</a></li>
    </ul>
  </div>



<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'wfblog';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

<footer>
<p>&copy; 2010 ~ 2030  Walter Fan <a href="https://beian.miit.gov.cn" target="_blank">皖ICP备20001876号-1</a></p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><!-- StatusCake -->

<!-- End StatusCake --></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Walter Fan's Blog ",
  "url" : ".",
  "image": "./images/walterfan.jpg",
  "description": "an old programmer never die, he just branch to a new address."
}
</script>
</body>
</html>