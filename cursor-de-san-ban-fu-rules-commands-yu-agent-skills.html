
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="./theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">


  <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="./images/favicon.ico" type="image/x-icon">










 

<meta name="author" content="Walter Fan" />
<meta name="description" content="深入理解 Cursor 的 Rules、Commands 和 Agent Skills——它们不只是配置文件，而是&#34;教 AI 如何帮你干活&#34;的说明书" />
<meta name="keywords" content="cursor, ai-coding, agent, mcp, productivity">


  <meta property="og:site_name" content="Walter Fan's Blog"/>
  <meta property="og:title" content="Cursor 的三板斧：Rules, Commands 与 Agent Skills"/>
  <meta property="og:description" content="深入理解 Cursor 的 Rules、Commands 和 Agent Skills——它们不只是配置文件，而是&#34;教 AI 如何帮你干活&#34;的说明书"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./cursor-de-san-ban-fu-rules-commands-yu-agent-skills.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2026-01-12 20:20:00+08:00"/>
  <meta property="article:modified_time" content="2026-01-12 22:30:00+08:00"/>
  <meta property="article:author" content="./author/walter-fan.html">
  <meta property="article:section" content="Journal"/>
  <meta property="article:tag" content="cursor"/>
  <meta property="article:tag" content="ai-coding"/>
  <meta property="article:tag" content="agent"/>
  <meta property="article:tag" content="mcp"/>
  <meta property="article:tag" content="productivity"/>
  <meta property="og:image" content="./images/walterfan.jpg">

  <title>Walter Fan's Blog &ndash; Cursor 的三板斧：Rules, Commands 与 Agent Skills</title>


</head>
<body class="light-theme">

<aside>
  <div>
    <a href="./">
      <img src="./images/walterfan.jpg" alt="Walter Fan" title="Walter Fan">
    </a>

    <h1>
      <a href="./">Walter Fan</a>
    </h1>

    <p>手握灵珠常奋笔, 心开天籁不吹箫</p>


    <nav>
      <ul class="list">



          <li>
            <a target="_blank" href="tao.html" >tao</a>
          </li>
          <li>
            <a target="_blank" href="article.html" >article</a>
          </li>
          <li>
            <a target="_blank" href="manual.html" >manual</a>
          </li>
          <li>
            <a target="_blank" href="interest.html" >interest</a>
          </li>
          <li>
            <a target="_self" href="/wordpress" >notebook</a>
          </li>
          <li>
            <a target="_blank" href="bookmark.html" >bookmark</a>
          </li>
          <li>
            <a target="_self" href="/webrtc/examples/index.html" >webrtc</a>
          </li>
          <li>
            <a target="_blank" href="https://github.com/walterfan" >github</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="http://github.com/walterfan"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="cursor-de-san-ban-fu-rules-commands-yu-agent-skills">Cursor 的三板斧：Rules, Commands 与 Agent Skills</h1>
    <p>
      Posted on Mon 12 January 2026 in <a href="./category/journal.html">Journal</a>

    </p>
  </header>


  <div>
    <table>
<thead>
<tr>
<th><strong>Abstract</strong></th>
<th>Cursor 的三板斧：Rules, Commands 与 Agent Skills</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Authors</strong></td>
<td><a href="https://www.fanyamin.com">Walter Fan</a></td>
</tr>
<tr>
<td><strong>Category</strong></td>
<td>learning note</td>
</tr>
<tr>
<td><strong>Status</strong></td>
<td>v1.0</td>
</tr>
<tr>
<td><strong>Updated</strong></td>
<td>2026-01-12</td>
</tr>
<tr>
<td><strong>License</strong></td>
<td><a href="http://creativecommons.org/licenses/by-nc-nd/4.0">CC-BY-NC-ND 4.0</a></td>
</tr>
</tbody>
</table>
<h1 id="cursor-rules-commands-agent-skills">Cursor 的三板斧：Rules, Commands 与 Agent Skills</h1>
<blockquote>
<p>工具的上限，取决于你怎么"调教"它。</p>
</blockquote>
<hr>
<h2 id="_1">一个让我汗颜的发现</h2>
<p>前几天，我看到一个同事用 Cursor 写技术设计文档。</p>
<p>他敲了一行 <code>/design-doc 用户认证服务重构 @JIRA-12345</code>，然后喝了口咖啡。等他放下杯子，一篇结构完整的设计文档已经生成好了——背景、目标、方案对比、架构图描述、API 设计、风险评估，一应俱全。更神奇的是，它还自动从 Jira ticket 里提取了需求背景。</p>
<p>我愣了三秒钟。</p>
<p>我用 Cursor 也快一年了，但我的用法还停留在"Tab 补全"和"Cmd+K 问问题"的阶段。这就像买了一辆特斯拉，结果只用来听收音机。</p>
<p>那天之后，我花了一周时间研究 Cursor 的 Rules、Commands 和最近大热的 Agent Skills。越研究越觉得：<strong>这东西的能力边界，远比我想象的大。</strong></p>
<p>今天这篇文章，我想把这些东西掰开揉碎，讲清楚它们是什么、为什么重要、怎么用。</p>
<hr>
<h2 id="what">What：这三样东西到底是什么？</h2>
<h3 id="1-cursor-rules-ai">1. Cursor Rules：给 AI 立规矩</h3>
<p><strong>一句话定义</strong>：Rules 是你写给 AI 的"行为准则"，告诉它"你是谁、你怎么做事、你有什么偏好"。</p>
<p>它存放在 <code>.cursor/rules/</code> 目录下，是一个 Markdown 文件（通常带 <code>.mdc</code> 后缀）。</p>
<p>举个例子，我的 <code>core.mdc</code> 里写着：</p>
<div class="highlight"><pre><span></span><code>---
<span class="gu">alwaysApply: true</span>
<span class="gu">---</span>

<span class="gh"># Author Background &amp; Writing Style</span>

<span class="gu">## Background (who I am)</span>
<span class="k">-</span><span class="w"> </span>I&#39;m an &quot;old programmer&quot; focused on backend/server development...
<span class="k">-</span><span class="w"> </span>Tech Stack: Java / C++ / Python / Go / JavaScript
<span class="k">-</span><span class="w"> </span>Domain: Telephony, database, networking, WebRTC, collaboration platforms and Web Service governance

<span class="gu">## Writing voice (how I write)</span>
<span class="k">-</span><span class="w"> </span>Prefer a &quot;senior columnist / tech blogger&quot; voice
<span class="k">-</span><span class="w"> </span>Tone: humorous but restrained
<span class="k">-</span><span class="w"> </span>Style: conversational Chinese by default
</code></pre></div>

<p>有了这个 Rules，每次我让 Cursor 帮我写东西，它就知道：</p>
<ul>
<li>我是个老程序员，别跟我整花里胡哨的</li>
<li>我喜欢中文写作，偶尔夹杂英文术语</li>
<li>我的风格是"有料但不装"</li>
</ul>
<p><strong>Rules 的本质</strong>：它是一个持久化的 System Prompt，让 AI 记住"你是谁"。</p>
<h3 id="2-cursor-commands-ai">2. Cursor Commands：给 AI 下任务</h3>
<p><strong>一句话定义</strong>：Commands 是你预设的"任务模板"，用 <code>/command-name</code> 触发，让 AI 按照你定义的流程执行复杂任务。</p>
<p>它存放在 <code>.cursor/commands/</code> 目录下，也是 Markdown 文件。</p>
<p>比如我的 <code>design-doc.md</code>：</p>
<div class="highlight"><pre><span></span><code><span class="gh"># Design Doc Generator</span>

你是一位资深架构师，擅长编写清晰、完整的技术设计文档。

<span class="gu">## Usage</span>
<span class="k">-</span><span class="w"> </span><span class="sb">`/design-doc &lt;feature-name&gt;`</span> - 生成设计文档
<span class="k">-</span><span class="w"> </span><span class="sb">`/design-doc &lt;feature-name&gt; @&lt;jira-ticket&gt;`</span> - 从 Jira 提取背景

<span class="gu">## Instructions:</span>
<span class="k">1.</span> 如果提供了 Jira ticket，先读取需求背景
<span class="k">2.</span> 按照公司模板生成设计文档：
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Background &amp; Motivation
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Goals &amp; Non-Goals
<span class="w">   </span><span class="k">-</span><span class="w"> </span>High-Level Design
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Detailed Design (API, Data Model, Sequence Diagram)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Alternatives Considered
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Risks &amp; Mitigations
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Timeline &amp; Milestones
<span class="k">3.</span> 使用 PlantUML 生成架构图和时序图
<span class="k">4.</span> 输出到 <span class="sb">`docs/design/`</span> 目录
</code></pre></div>

<p>当我输入 <code>/design-doc 用户认证服务重构 @JIRA-12345</code>，Cursor 就会：</p>
<ol>
<li>通过 MCP 调用 Jira API，读取 JIRA-12345 的需求描述</li>
<li>按照我定义的模板结构生成设计文档</li>
<li>自动生成 PlantUML 图表</li>
<li>创建文件到指定目录</li>
</ol>
<p><strong>Commands 的本质</strong>：它是一个可复用的 Prompt 模板 + 工作流定义。</p>
<h3 id="3-agent-skills-ai">3. Agent Skills：给 AI 加技能</h3>
<p><strong>一句话定义</strong>：Agent Skills 是一种轻量级、开放的格式，用于扩展 AI Agent 的能力，为它提供专业知识和工作流。</p>
<p>根据 <a href="https://agentskills.io/what-are-skills">Agent Skills 官方规范</a>，一个 Skill 本质上就是一个包含 <code>SKILL.md</code> 文件的文件夹：</p>
<div class="highlight"><pre><span></span><code>my-skill/
├── SKILL.md          # 必需：指令 + 元数据
├── scripts/          # 可选：可执行代码
├── references/       # 可选：参考文档
└── assets/           # 可选：模板、资源
</code></pre></div>

<p><code>SKILL.md</code> 的结构很简单：</p>
<div class="highlight"><pre><span></span><code>---
name: design-doc-generator
<span class="gu">description: Generate technical design documents from requirements</span>
<span class="gu">---</span>

<span class="gh"># Design Doc Generator</span>

<span class="gu">## When to use this skill</span>
Use this skill when the user needs to create a technical design document...

<span class="gu">## How to generate a design doc</span>
<span class="k">1.</span> Extract requirements from Jira ticket
<span class="k">2.</span> Follow the company template structure
<span class="k">3.</span> Generate PlantUML diagrams
...
</code></pre></div>

<p><strong>Agent Skills 的工作机制</strong>（渐进式披露）：</p>
<ol>
<li><strong>发现（Discovery）</strong>：启动时，Agent 只加载每个 Skill 的 <code>name</code> 和 <code>description</code>，知道它大概能干什么</li>
<li><strong>激活（Activation）</strong>：当任务匹配某个 Skill 的描述时，Agent 读取完整的 <code>SKILL.md</code> 指令</li>
<li><strong>执行（Execution）</strong>：Agent 按照指令执行，按需加载引用的文件或执行捆绑的代码</li>
</ol>
<p>这种设计的好处是：<strong>保持 Agent 响应速度的同时，让它能按需获取更多上下文</strong>。</p>
<hr>
<p><strong>另一个相关概念：MCP（Model Context Protocol）</strong></p>
<p>MCP 是 Anthropic 提出的协议，让 AI 能够调用外部工具：</p>
<ul>
<li>读取文件系统</li>
<li>执行终端命令</li>
<li>调用外部 API（Jira、GitLab、Confluence 等）</li>
<li>访问数据库</li>
<li>操作浏览器</li>
</ul>
<p>在 Cursor 里，这些能力通过 MCP Server 提供。你可以把它理解为"AI 的手和脚"。</p>
<p><strong>Skills vs MCP 的关系</strong>：
- <strong>Skills</strong> 定义"做什么"和"怎么做"（知识和流程）
- <strong>MCP</strong> 提供"能做什么"（工具和能力）</p>
<p>两者结合，AI 就不只是个"嘴炮"，而是真的能帮你干活。</p>
<hr>
<h2 id="why">Why：为什么这三样东西这么重要？</h2>
<h3 id="1">1. 从"问答机器"到"个人助理"</h3>
<p>没有 Rules、Commands、Agent Skills 的 AI，就像一个刚入职的实习生——聪明，但不了解你，不了解公司，不了解项目。每次你都得从头解释一遍背景。</p>
<p>有了这三样东西，AI 就变成了一个"跟了你三年的助理"——知道你的风格、了解你的项目、熟悉你的工作流。</p>
<h3 id="2">2. 从"一次性对话"到"可复用工作流"</h3>
<p>你有没有过这种经历：</p>
<blockquote>
<p>花了 20 分钟跟 ChatGPT 调教出一个完美的 Prompt，生成了一篇很棒的内容。
第二天想再用，发现那个 Prompt 找不到了……</p>
</blockquote>
<p>Commands 解决的就是这个问题。把好用的 Prompt 固化成 Command，下次一行 <code>/xxx</code> 就能复用。</p>
<h3 id="3">3. 从"只会说"到"能做事"</h3>
<p>传统的 LLM 只能"生成文本"。你问它"帮我创建一个文件"，它只会告诉你"你可以用 touch 命令创建文件"。</p>
<p>有了 Agent Skills 和 MCP：
- <strong>Skills</strong> 告诉 AI "生成设计文档的流程是什么"
- <strong>MCP</strong> 让 AI 能"真的去读 Jira、写文件、调 API"</p>
<p>两者结合，AI 真的可以帮你完成端到端的任务。这是质的飞跃。</p>
<hr>
<h2 id="how">How：怎么用好这三样东西？</h2>
<h3 id="step-1-rules">Step 1：写好你的 Rules</h3>
<p><strong>位置</strong>：<code>.cursor/rules/core.mdc</code>（或其他 <code>.mdc</code> 文件）</p>
<p><strong>关键要素</strong>：</p>
<div class="highlight"><pre><span></span><code>---
<span class="gu">alwaysApply: true  # 是否始终应用</span>
<span class="gu">---</span>

<span class="gh"># 1. 你是谁</span>
<span class="k">-</span><span class="w"> </span>你的背景、角色、专业领域

<span class="gh"># 2. 你怎么做事</span>
<span class="k">-</span><span class="w"> </span>你的写作/编码风格
<span class="k">-</span><span class="w"> </span>你的偏好和禁忌

<span class="gh"># 3. 输出规范</span>
<span class="k">-</span><span class="w"> </span>格式要求
<span class="k">-</span><span class="w"> </span>语言要求
<span class="k">-</span><span class="w"> </span>其他约束
</code></pre></div>

<p><strong>我的经验</strong>：</p>
<ul>
<li>Rules 不要太长，500 行以内</li>
<li>要具体，别写"写得好一点"这种废话</li>
<li>可以分多个文件，按场景组织（比如 <code>coding.mdc</code>、<code>writing.mdc</code>）</li>
</ul>
<h3 id="step-2-commands">Step 2：创建你的 Commands</h3>
<p><strong>位置</strong>：<code>.cursor/commands/xxx.md</code></p>
<p><strong>基本结构</strong>：</p>
<div class="highlight"><pre><span></span><code><span class="gh"># Command Name</span>

一句话描述这个 Command 干什么

<span class="gu">## Usage</span>
<span class="k">-</span><span class="w"> </span><span class="sb">`/command-name`</span> - 基本用法
<span class="k">-</span><span class="w"> </span><span class="sb">`/command-name &lt;arg&gt;`</span> - 带参数用法

<span class="gu">## Instructions</span>
<span class="k">1.</span> 第一步做什么
<span class="k">2.</span> 第二步做什么
<span class="k">3.</span> ...

<span class="gu">## Example</span>
输入：...
输出：...
</code></pre></div>

<p><strong>我常用的 Commands</strong>：</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/design-doc</code></td>
<td>生成技术设计文档</td>
</tr>
<tr>
<td><code>/api-spec</code></td>
<td>生成 API 接口规范</td>
</tr>
<tr>
<td><code>/code-review</code></td>
<td>代码审查</td>
</tr>
<tr>
<td><code>/explain-code</code></td>
<td>解释代码逻辑</td>
</tr>
<tr>
<td><code>/test-cases</code></td>
<td>根据需求生成测试用例</td>
</tr>
<tr>
<td><code>/release-notes</code></td>
<td>生成发布说明</td>
</tr>
</tbody>
</table>
<h3 id="step-3-agent-skills">Step 3：创建你的 Agent Skills</h3>
<p><strong>位置</strong>：项目根目录下创建 <code>skills/</code> 文件夹</p>
<p>根据 <a href="https://agentskills.io/what-are-skills">Agent Skills 规范</a>，每个 Skill 是一个独立的文件夹：</p>
<div class="highlight"><pre><span></span><code>skills/
├── design-doc/
│   ├── SKILL.md              # 必需：指令和元数据
│   ├── templates/            # 设计文档模板
│   │   └── design-template.md
│   └── references/           # 参考资料
│       └── best-practices.md
├── api-spec/
│   ├── SKILL.md
│   └── templates/
│       └── openapi-template.yaml
└── code-review/
    └── SKILL.md
</code></pre></div>

<p><strong>一个 SKILL.md 示例</strong>（设计文档生成）：</p>
<div class="highlight"><pre><span></span><code>---
name: design-doc-generator
<span class="gu">description: Generate technical design documents from Jira requirements, following company standards</span>
<span class="gu">---</span>

<span class="gh"># Design Doc Generator</span>

<span class="gu">## When to use this skill</span>
Use this skill when:
<span class="k">-</span><span class="w"> </span>User needs to create a technical design document
<span class="k">-</span><span class="w"> </span>User mentions &quot;design doc&quot;, &quot;TDD&quot;, &quot;technical spec&quot;
<span class="k">-</span><span class="w"> </span>User references a Jira ticket for a new feature

<span class="gu">## Prerequisites</span>
<span class="k">-</span><span class="w"> </span>Jira MCP configured for reading tickets
<span class="k">-</span><span class="w"> </span>Access to company design doc templates

<span class="gu">## How to generate a design doc</span>

<span class="gu">### Step 1: Gather requirements</span>
<span class="k">1.</span> Read the Jira ticket using <span class="sb">`@JIRA-xxxxx`</span>
<span class="k">2.</span> Extract: summary, description, acceptance criteria, linked epics

<span class="gu">### Step 2: Generate document structure</span>
Follow the template in <span class="sb">`templates/design-template.md`</span>:
<span class="k">-</span><span class="w"> </span>Background &amp; Motivation
<span class="k">-</span><span class="w"> </span>Goals &amp; Non-Goals
<span class="k">-</span><span class="w"> </span>High-Level Design
<span class="k">-</span><span class="w"> </span>Detailed Design
<span class="k">-</span><span class="w"> </span>Alternatives Considered
<span class="k">-</span><span class="w"> </span>Risks &amp; Mitigations
<span class="k">-</span><span class="w"> </span>Timeline

<span class="gu">### Step 3: Create diagrams</span>
Use PlantUML for:
<span class="k">-</span><span class="w"> </span>Architecture diagrams
<span class="k">-</span><span class="w"> </span>Sequence diagrams
<span class="k">-</span><span class="w"> </span>Data flow diagrams

<span class="gu">### Step 4: Output</span>
Save to <span class="sb">`docs/design/{feature-name}.md`</span>
</code></pre></div>

<h3 id="step-4-mcp-server">Step 4：配置 MCP Server</h3>
<p><strong>位置</strong>：Cursor 设置 → Features → MCP</p>
<p>MCP 提供 Agent Skills 执行时需要的"工具"：</p>
<ul>
<li><strong>File System</strong>：读写文件</li>
<li><strong>Terminal</strong>：执行命令</li>
<li><strong>Browser</strong>：操作浏览器（Playwright）</li>
<li><strong>Jira/GitLab</strong>：读取项目管理和代码仓库</li>
</ul>
<p><strong>配置示例</strong>（在 Cursor 设置中）：</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;mcpServers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;filesystem&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;npx&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;-y&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;@anthropic/mcp-filesystem&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;jira&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;node&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;path/to/jira-mcp-server.js&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;gitlab&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;node&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;path/to/gitlab-mcp-server.js&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr>
<h2 id="example">Example：一个完整的工作流示例</h2>
<p>假设我要为一个新功能写技术设计文档，我的工作流是这样的：</p>
<p><strong>场景</strong>：产品经理在 Jira 上创建了一个 ticket JIRA-12345，要求重构用户认证服务，支持 OAuth 2.0 和 SAML。</p>
<p><strong>1. 触发 Command</strong></p>
<div class="highlight"><pre><span></span><code>/design-doc 用户认证服务重构 @JIRA-12345
</code></pre></div>

<p><strong>2. Cursor 读取 Rules</strong></p>
<p>它知道我是谁、我的团队用什么技术栈、我们的设计文档规范是什么。</p>
<p>比如我的 Rules 里写着：</p>
<div class="highlight"><pre><span></span><code><span class="gu">## 技术栈偏好</span>
<span class="k">-</span><span class="w"> </span>后端：Java 17 + Spring Boot 3
<span class="k">-</span><span class="w"> </span>数据库：PostgreSQL
<span class="k">-</span><span class="w"> </span>缓存：Redis
<span class="k">-</span><span class="w"> </span>消息队列：Kafka
<span class="k">-</span><span class="w"> </span>容器化：Kubernetes

<span class="gu">## 设计文档规范</span>
<span class="k">-</span><span class="w"> </span>必须包含：背景、目标、非目标、方案对比、风险评估
<span class="k">-</span><span class="w"> </span>架构图使用 PlantUML
<span class="k">-</span><span class="w"> </span>API 设计遵循 RESTful 规范
<span class="k">-</span><span class="w"> </span>必须考虑向后兼容性
</code></pre></div>

<p><strong>3. Cursor 调用 Agent Skills（MCP）</strong></p>
<ul>
<li><strong>Jira MCP</strong>：读取 JIRA-12345 的需求描述、验收标准、关联的 Epic</li>
<li><strong>GitLab MCP</strong>：查看现有认证服务的代码结构和 API</li>
<li><strong>File System</strong>：读取团队之前的设计文档作为参考</li>
</ul>
<p><strong>4. Cursor 执行 Command 中定义的流程</strong></p>
<ul>
<li>分析需求，提取关键点</li>
<li>生成文档结构</li>
<li>撰写各个章节</li>
<li>用 PlantUML 生成架构图和时序图</li>
<li>列出方案对比（OAuth 2.0 vs SAML vs 自研）</li>
<li>评估风险和缓解措施</li>
</ul>
<p><strong>5. 输出结果</strong></p>
<p>一份完整的设计文档，大概长这样：</p>
<div class="highlight"><pre><span></span><code><span class="gh"># 用户认证服务重构设计文档</span>

<span class="gu">## 1. Background &amp; Motivation</span>
当前认证服务基于自研的 Session-based 方案，存在以下问题：
<span class="k">-</span><span class="w"> </span>不支持 SSO，企业客户接入成本高
<span class="k">-</span><span class="w"> </span>Session 存储在单机内存，无法水平扩展
<span class="k">-</span><span class="w"> </span>缺乏标准化的 Token 管理机制

<span class="gu">## 2. Goals</span>
<span class="k">-</span><span class="w"> </span>支持 OAuth 2.0 Authorization Code Flow
<span class="k">-</span><span class="w"> </span>支持 SAML 2.0 SSO
<span class="k">-</span><span class="w"> </span>Token 存储迁移到 Redis，支持水平扩展

<span class="gu">## 3. Non-Goals</span>
<span class="k">-</span><span class="w"> </span>本次不涉及 MFA 改造
<span class="k">-</span><span class="w"> </span>不改变现有用户数据模型

<span class="gu">## 4. High-Level Design</span>
[PlantUML 架构图]

<span class="gu">## 5. Detailed Design</span>
<span class="gu">### 5.1 API Design</span>
<span class="k">-</span><span class="w"> </span>POST /oauth/authorize
<span class="k">-</span><span class="w"> </span>POST /oauth/token
<span class="k">-</span><span class="w"> </span>GET /oauth/userinfo

<span class="gu">### 5.2 Data Model</span>
[Token 存储结构]

<span class="gu">### 5.3 Sequence Diagram</span>
[PlantUML 时序图]

<span class="gu">## 6. Alternatives Considered</span>
| 方案 | 优点 | 缺点 | 结论 |
|------|------|------|------|
| 自研 OAuth | 灵活 | 开发成本高 | ❌ |
| Spring Security OAuth | 成熟 | 配置复杂 | ✅ |
| Keycloak | 功能全 | 运维成本高 | ❌ |

<span class="gu">## 7. Risks &amp; Mitigations</span>
<span class="k">-</span><span class="w"> </span>风险1：Token 迁移期间服务中断
<span class="w">  </span><span class="k">-</span><span class="w"> </span>缓解：采用双写策略，灰度切换

<span class="gu">## 8. Timeline</span>
<span class="k">-</span><span class="w"> </span>Week 1-2: 核心 OAuth 实现
<span class="k">-</span><span class="w"> </span>Week 3: SAML 集成
<span class="k">-</span><span class="w"> </span>Week 4: 测试和灰度
</code></pre></div>

<p><strong>6. 后续操作</strong></p>
<ul>
<li>Cursor 自动创建文件 <code>docs/design/auth-service-refactor.md</code></li>
<li>如果配置了 Confluence MCP，还可以直接同步到 Wiki</li>
</ul>
<p>整个过程，我只输入了一行命令。以前写这样一份设计文档，至少要花半天时间。</p>
<hr>
<h2 id="_2">一些实用技巧</h2>
<h3 id="1-rules">1. Rules 的分层策略</h3>
<div class="highlight"><pre><span></span><code>.cursor/rules/
├── core.mdc          # 全局规则，始终生效
├── coding.mdc        # 编码相关规则
├── writing.mdc       # 写作相关规则
└── project-xxx.mdc   # 特定项目规则
</code></pre></div>

<p>用 <code>alwaysApply: true/false</code> 控制是否自动应用。</p>
<h3 id="2-commands">2. Commands 的命名规范</h3>
<ul>
<li>用动词或名词开头：<code>design-doc</code>、<code>code-review</code>、<code>api-spec</code></li>
<li>保持简短：能用一个词就别用两个</li>
<li>语义清晰：看名字就知道干什么</li>
</ul>
<h3 id="3_1">3. 善用 @ 引用</h3>
<p>在 Cursor 中，你可以用 <code>@</code> 引用文件、文件夹、Jira ticket、甚至网页：</p>
<div class="highlight"><pre><span></span><code>/design-doc 支付网关重构 @ZOOM-67890
</code></pre></div>

<div class="highlight"><pre><span></span><code>帮我分析 @https://example.com/api-doc 这个 API 文档，生成对应的客户端 SDK
</code></pre></div>

<div class="highlight"><pre><span></span><code>根据 @docs/design/auth-service.md 生成测试用例
</code></pre></div>

<h3 id="4-prompt">4. 迭代优化你的 Prompt</h3>
<p>Commands 里的 Prompt 不是一次写好的。我的建议：</p>
<ol>
<li>先写一个"能用"的版本</li>
<li>用几次，发现问题</li>
<li>针对问题优化 Prompt</li>
<li>重复 2-3，直到满意</li>
</ol>
<hr>
<h2 id="_3">总结</h2>
<table>
<thead>
<tr>
<th>概念</th>
<th>是什么</th>
<th>解决什么问题</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Rules</strong></td>
<td>AI 的行为准则（持久化 System Prompt）</td>
<td>让 AI 记住"你是谁"、你的偏好和规范</td>
</tr>
<tr>
<td><strong>Commands</strong></td>
<td>预设的任务模板（可复用 Prompt）</td>
<td>让复杂任务一行命令触发</td>
</tr>
<tr>
<td><strong>Agent Skills</strong></td>
<td>专业知识和工作流（<code>SKILL.md</code> + 资源）</td>
<td>让 AI 掌握特定领域的"做事方法"</td>
</tr>
<tr>
<td><strong>MCP</strong></td>
<td>AI 的工具箱（外部能力接口）</td>
<td>让 AI 能调用文件系统、API、数据库等</td>
</tr>
</tbody>
</table>
<p>四者的关系：</p>
<div class="highlight"><pre><span></span><code>Rules（你是谁）+ Commands（做什么）+ Skills（怎么做）+ MCP（用什么工具）
                              ↓
                   可编程的 AI 助手
</code></pre></div>

<p>三者结合，Cursor 就从一个"智能补全工具"变成了一个"可编程的 AI 助手"。</p>
<hr>
<h2 id="checklist">Checklist：你可以现在就做的事</h2>
<ul>
<li>[ ] 在 <code>.cursor/rules/</code> 下创建你的 <code>core.mdc</code>，写下你的背景、技术栈和团队规范</li>
<li>[ ] 把你常用的文档模板（设计文档、API 规范、测试用例）整理成 Commands</li>
<li>[ ] 配置 Jira/GitLab MCP，让 AI 能读取你的项目上下文</li>
<li>[ ] 尝试用 <code>/design-doc</code> 生成一份设计文档，体验一下"一行命令完成复杂任务"的快感</li>
<li>[ ] 把生成的文档分享给同事，收集反馈，持续优化你的 Commands</li>
</ul>
<hr>
<h2 id="_4">扩展阅读</h2>
<ul>
<li><a href="https://docs.cursor.com/context/rules-for-ai">Cursor 官方文档 - Rules</a></li>
<li><a href="https://docs.cursor.com/chat/custom-commands">Cursor 官方文档 - Commands</a></li>
<li><a href="https://agentskills.io/what-are-skills">Agent Skills 官方文档</a> - 什么是 Agent Skills，如何编写</li>
<li><a href="https://agentskills.io/specification">Agent Skills 规范</a> - SKILL.md 的完整格式规范</li>
<li><a href="https://modelcontextprotocol.io/">Model Context Protocol (MCP) 介绍</a></li>
<li><a href="https://github.com/anthropics/anthropic-cookbook/tree/main/misc/model_context_protocol">Anthropic MCP GitHub</a></li>
<li><a href="https://github.com/PatrickJS/awesome-cursorrules">Awesome Cursor Rules</a> - 社区收集的优秀 Rules 示例</li>
</ul>
<hr>
<h2 id="_5">最后一句</h2>
<blockquote>
<p><strong>工具的上限，不取决于工具本身，而取决于你怎么"调教"它。</strong></p>
</blockquote>
<p>Rules、Commands、Agent Skills，本质上都是在"教 AI 如何帮你干活"。</p>
<p>教得好，它就是你的超级助理。
教得不好，它就只是一个贵一点的自动补全。</p>
<p>所以，别只是"用"Cursor，要学会"调教"它。</p>
<hr>
<div class="highlight"><pre><span></span><code>@startmindmap
* Cursor 三板斧
** Rules 规则
*** 给 AI 立规矩
*** 行为准则
*** 持久化 System Prompt
*** 存放在 .cursor/rules/
** Commands 命令
*** 给 AI 下任务
*** 任务模板
*** 用 /command 触发
*** 存放在 .cursor/commands/
** Agent Skills 技能
*** 给 AI 加能力
*** 可复用工作流
*** 多步骤自动化
*** 支持 MCP 工具
** 核心理念
*** 工具上限取决于调教
*** Rules 是身份
*** Commands 是任务
*** Skills 是能力
@endmindmap
</code></pre></div>

<p><img alt="Cursor 三板斧思维导图" src="../images/journal_20260112_cursor_mindmap.png"></p>
<hr/>
<p>本作品采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可。</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/cursor.html">cursor</a>
      <a href="./tag/ai-coding.html">ai-coding</a>
      <a href="./tag/agent.html">agent</a>
      <a href="./tag/mcp.html">mcp</a>
      <a href="./tag/productivity.html">productivity</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="./zhi-chang-zhong-na-xie-huo-de-zui-jiu-de-fang-fa-lun-suo-xie.html" title="职场中那些“活得最久”的方法论缩写">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="./shi-yong-di-yi-xing-yuan-li-zuo-jia-gou-she-ji.html" title="使用第一性原理做架构设计">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="./prompt-as-codedang-prompt-bu-zhi-shi-hua-er-shi-ke-zhi-xing-de-cheng-xu.html">Prompt-as-Code：当 Prompt 不只是"话"，而是可执行的"程序"</a></li>
      <li><a href="./tips-for-vibe-coding-with-cursor-bie-rang-ai-cai-ni-de-xin-si.html">Tips for Vibe Coding with Cursor: 别让 AI 猜你的心思</a></li>
      <li><a href="./yong-ai-agent-chu-li-fu-za-liu-cheng-xian-xie-workflowzai-xie-prompt.html">用 AI Agent 处理复杂流程：先写 Workflow，再写 Prompt</a></li>
      <li><a href="./ru-he-da-zao-ge-ren-yu-xiang-mu-zhi-shi-ku-cong-quan-wen-sou-suo-dao-ragzai-dao-claude-skill.html">如何打造个人与项目知识库：从全文搜索到 RAG，再到 Claude Skill</a></li>
      <li><a href="./agent-skillsgei-ai-zhu-shou-zhuang-shang-ji-neng-bao.html">Agent Skills：给 AI 助手装上"技能包"</a></li>
    </ul>
  </div>



<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'wfblog';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

<footer>
<p>&copy; 2010 ~ 2030  Walter Fan <a href="https://beian.miit.gov.cn" target="_blank">皖ICP备20001876号-1</a></p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><!-- StatusCake -->

<!-- End StatusCake --></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Walter Fan's Blog ",
  "url" : ".",
  "image": "./images/walterfan.jpg",
  "description": "an old programmer never die, he just branch to a new address."
}
</script>
</body>
</html>