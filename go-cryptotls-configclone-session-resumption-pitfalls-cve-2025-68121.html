
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="./theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">


  <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="./images/favicon.ico" type="image/x-icon">










 

<meta name="author" content="Walter Fan" />
<meta name="description" content="CVE-2025-68121 æ¶‰åŠ Go crypto/tls çš„ä¸¤ä¸ªä¼šè¯æ¢å¤ï¼ˆsession resumptionï¼‰é—®é¢˜ï¼šConfig.Clone å¤åˆ¶äº†è‡ªåŠ¨ç”Ÿæˆçš„ session ticket keysï¼Œå¯¼è‡´ä¸åŒ tls.Config ä¹‹é—´æ„å¤–å…±äº«ä¼šè¯ç¥¨æ®ï¼›ä»¥åŠæœåŠ¡ç«¯åœ¨åˆ¤æ–­ä¼šè¯æ˜¯å¦å¯æ¢å¤æ—¶ï¼Œåªæ£€æŸ¥ leaf è¯ä¹¦è¿‡æœŸè€Œå¿½ç•¥å®Œæ•´è¯ä¹¦é“¾ï¼Œå¯èƒ½è®©è¿‡æœŸé“¾æ¡ä¸‹çš„ä¼šè¯ç»§ç»­è¢«æ¢å¤ã€‚" />
<meta name="keywords" content="go, security, tls, cve">


  <meta property="og:site_name" content="Walter Fan's Blog"/>
  <meta property="og:title" content="Go crypto/tls Config.Clone session resumption pitfalls (CVE-2025-68121)"/>
  <meta property="og:description" content="CVE-2025-68121 æ¶‰åŠ Go crypto/tls çš„ä¸¤ä¸ªä¼šè¯æ¢å¤ï¼ˆsession resumptionï¼‰é—®é¢˜ï¼šConfig.Clone å¤åˆ¶äº†è‡ªåŠ¨ç”Ÿæˆçš„ session ticket keysï¼Œå¯¼è‡´ä¸åŒ tls.Config ä¹‹é—´æ„å¤–å…±äº«ä¼šè¯ç¥¨æ®ï¼›ä»¥åŠæœåŠ¡ç«¯åœ¨åˆ¤æ–­ä¼šè¯æ˜¯å¦å¯æ¢å¤æ—¶ï¼Œåªæ£€æŸ¥ leaf è¯ä¹¦è¿‡æœŸè€Œå¿½ç•¥å®Œæ•´è¯ä¹¦é“¾ï¼Œå¯èƒ½è®©è¿‡æœŸé“¾æ¡ä¸‹çš„ä¼šè¯ç»§ç»­è¢«æ¢å¤ã€‚"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./go-cryptotls-configclone-session-resumption-pitfalls-cve-2025-68121.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2026-02-25 13:30:00+08:00"/>
  <meta property="article:modified_time" content="2026-02-25 13:55:00+08:00"/>
  <meta property="article:author" content="./author/walter-fan.html">
  <meta property="article:section" content="Tech"/>
  <meta property="article:tag" content="go"/>
  <meta property="article:tag" content="security"/>
  <meta property="article:tag" content="tls"/>
  <meta property="article:tag" content="cve"/>
  <meta property="og:image" content="./images/walterfan.jpg">

  <title>Walter Fan's Blog &ndash; Go crypto/tls Config.Clone session resumption pitfalls (CVE-2025-68121)</title>


</head>
<body class="light-theme">

<aside>
  <div>
    <a href="./">
      <img src="./images/walterfan.jpg" alt="Walter Fan" title="Walter Fan">
    </a>

    <h1>
      <a href="./">Walter Fan</a>
    </h1>

    <p>æ‰‹æ¡çµç å¸¸å¥‹ç¬”, å¿ƒå¼€å¤©ç±ä¸å¹ç®«</p>


    <nav>
      <ul class="list">



          <li>
            <a target="_blank" href="tao.html" >tao</a>
          </li>
          <li>
            <a target="_blank" href="article.html" >article</a>
          </li>
          <li>
            <a target="_blank" href="manual.html" >manual</a>
          </li>
          <li>
            <a target="_blank" href="interest.html" >interest</a>
          </li>
          <li>
            <a target="_self" href="/wordpress" >notebook</a>
          </li>
          <li>
            <a target="_blank" href="bookmark.html" >bookmark</a>
          </li>
          <li>
            <a target="_self" href="/webrtc/examples/index.html" >webrtc</a>
          </li>
          <li>
            <a target="_blank" href="https://github.com/walterfan" >github</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="http://github.com/walterfan"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="go-cryptotls-configclone-session-resumption-pitfalls-cve-2025-68121">Go crypto/tls Config.Clone session resumption pitfalls (CVE-2025-68121)</h1>
    <p>
      Posted on Wed 25 February 2026 in <a href="./category/tech.html">Tech</a>

    </p>
  </header>


  <div>
    <table>
<thead>
<tr>
<th><strong>Abstract</strong></th>
<th>Go crypto/tls Config.Clone session resumption pitfalls (CVE-2025-68121)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Authors</strong></td>
<td><a href="https://www.fanyamin.com">Walter Fan</a></td>
</tr>
<tr>
<td><strong>Category</strong></td>
<td>tech note</td>
</tr>
<tr>
<td><strong>Status</strong></td>
<td>v1.0</td>
</tr>
<tr>
<td><strong>Updated</strong></td>
<td>2026-02-25</td>
</tr>
<tr>
<td><strong>License</strong></td>
<td><a href="http://creativecommons.org/licenses/by-nc-nd/4.0">CC-BY-NC-ND 4.0</a></td>
</tr>
</tbody>
</table>
<h1 id="go-cryptotls-configclone-session-resumption-cve-2025-68121">Go <code>crypto/tls</code>: <code>Config.Clone</code> + Session Resumption çš„å®‰å…¨å‘ï¼ˆCVE-2025-68121ï¼‰</h1>
<h2 id="what">What</h2>
<p>è¿™æ¬¡é—®é¢˜å¯ä»¥æ‹†æˆä¸¤æ®µï¼ˆéƒ½å’Œ session resumption æœ‰å…³ï¼‰ï¼š</p>
<ol>
<li><strong><code>Config.Clone</code> æ„å¤–å¤åˆ¶è‡ªåŠ¨ç”Ÿæˆçš„ session ticket keys</strong></li>
<li>å¦‚æœä½ æ²¡æ˜¾å¼è®¾ç½® <code>Config.SessionTicketKey</code>ï¼Œä¹Ÿæ²¡è°ƒç”¨è¿‡ <code>Config.SetSessionTicketKeys</code>ï¼ŒGo çš„ <code>crypto/tls</code> ä¼šåœ¨æœåŠ¡å™¨ä¾§è‡ªåŠ¨ç”Ÿæˆå¹¶è½®æ¢ session ticket keysã€‚</li>
<li>
<p>åœ¨ä¿®å¤å‰ï¼Œ<code>Config.Clone()</code> ä¼šæŠŠè¿™äº›<strong>è‡ªåŠ¨ç”Ÿæˆçš„ keys ä¹Ÿå¤åˆ¶</strong>åˆ°æ–° Config é‡Œï¼Œå¯¼è‡´ä¸¤ä¸ª Config <strong>å…±äº«åŒä¸€å¥— ticket keys</strong>ã€‚</p>
</li>
<li>
<p><strong>æœåŠ¡ç«¯æ¢å¤ä¼šè¯æ—¶æœªè€ƒè™‘å®Œæ•´è¯ä¹¦é“¾è¿‡æœŸ</strong></p>
</li>
<li>åœ¨ä¿®å¤å‰ï¼ŒæœåŠ¡ç«¯åœ¨å†³å®šä¸€ä¸ªä¼šè¯æ˜¯å¦èƒ½æ¢å¤æ—¶ï¼Œåªæ£€æŸ¥äº†ï¼ˆå½“åˆæ¡æ‰‹æ—¶ï¼‰å¶å­è¯ä¹¦ï¼ˆleafï¼‰çš„è¿‡æœŸæƒ…å†µã€‚</li>
<li>å¦‚æœè¯ä¹¦é“¾é‡Œçš„ä¸­é—´è¯ä¹¦/æ ¹è¯ä¹¦è¿‡æœŸï¼Œä»å¯èƒ½å‘ç”Ÿ session resumptionã€‚</li>
</ol>
<p>è¿™ä¸¤ä¸ªç‚¹æ¥è‡ª Go issueï¼šCVE-2025-68121 / <code>crypto/tls</code> issue #77113ã€‚</p>
<h2 id="why">Whyï¼ˆå±å®³åœ¨å“ªé‡Œï¼‰</h2>
<h3 id="1-key-config">1) â€œé…ç½®éš”ç¦»â€å¤±æ•ˆï¼šç¥¨æ® key å…±äº«å¯¼è‡´è·¨ Config æ¢å¤</h3>
<p>åœ¨å¾ˆå¤šå·¥ç¨‹é‡Œï¼Œå¤§å®¶ä¼šè‡ªç„¶æŠŠä¸åŒçš„ <code>tls.Config</code> å½“ä½œâ€œéš”ç¦»è¾¹ç•Œâ€ï¼š</p>
<ul>
<li>ä¸åŒç«¯å£ / ä¸åŒè™šæ‹Ÿä¸»æœº / ä¸åŒç§Ÿæˆ·</li>
<li>ä¸åŒçš„ TLS ç­–ç•¥ï¼ˆcipher suitesã€æœ€å°ç‰ˆæœ¬ã€ClientAuth ä¹‹ç±»ï¼‰</li>
<li>ä¸åŒçš„è¯ä¹¦é“¾ï¼ˆç”šè‡³ä¸åŒçš„ CA/ä¸­é—´è¯ä¹¦ç»„åˆï¼‰</li>
</ul>
<p>å¦‚æœè¿™äº› Config å› ä¸º <code>Clone()</code> è€Œå…±äº«äº†è‡ªåŠ¨ç”Ÿæˆçš„ session ticket keysï¼Œé‚£ä¹ˆï¼š</p>
<ul>
<li>æŸä¸ª Config ä¸‹ç­¾å‘å‡ºæ¥çš„ session ticketï¼Œå¦ä¸€ä¸ª Config ä¹Ÿå¯èƒ½è§£å¾—å¼€å¹¶æ¥å—æ¢å¤</li>
<li>ä½ ä»¥ä¸ºçš„â€œæŒ‰ Config åˆ‡åˆ†çš„ session resumption è¾¹ç•Œâ€ï¼Œå¯èƒ½å°±è¢«æ‚„æ‚„æŠ¹å¹³äº†</li>
</ul>
<p>è¿™ç±» bug æœ€å±é™©çš„åœ°æ–¹åœ¨äºï¼š<strong>å®ƒä¸ä¼šè®© TLS ç›´æ¥æŠ¥é”™</strong>ï¼Œå¾ˆå¤šæ—¶å€™åªä¼šè®©â€œæœ¬æ¥ä¸è¯¥å‘ç”Ÿçš„æ¢å¤â€æ‚„æ‚„å‘ç”Ÿã€‚</p>
<h3 id="2">2) è¯ä¹¦é“¾è¿‡æœŸç­–ç•¥è¢«ç»•å¼€ï¼šè¿‡æœŸä¸­é—´è¯ä¹¦/æ ¹è¯ä¹¦ä¸‹ä»å¯æ¢å¤</h3>
<p>è¯ä¹¦è¿‡æœŸæœ¬æ¥æ˜¯ PKI çš„ç¡¬è¾¹ç•Œï¼šè¿‡æœŸå°±åº”å½“å¤±è´¥ã€‚</p>
<p>å¦‚æœ session resumption åœ¨æœåŠ¡ç«¯åªçœ‹ leafï¼Œè€Œä¸çœ‹å®Œæ•´é“¾æ¡ï¼Œé‚£ä¹ˆé“¾æ¡é‡ŒæŸäº›å…³é”®è¯ä¹¦ï¼ˆä¸­é—´è¯ä¹¦/æ ¹è¯ä¹¦ï¼‰è¿‡æœŸåï¼Œä¼šè¯å¯èƒ½ä»è¢«æ¢å¤ï¼š</p>
<ul>
<li>ä¸ç¬¦åˆä½ å¯¹è¯ä¹¦ç”Ÿå‘½å‘¨æœŸçš„é¢„æœŸ</li>
<li>åœ¨åˆè§„/å®¡è®¡è¯­å¢ƒä¸‹ä¼šå¾ˆå°´å°¬ï¼šè¯ä¹¦é“¾éƒ½è¿‡æœŸäº†ï¼Œè¿æ¥å´â€œçœ‹èµ·æ¥è¿˜èƒ½ç”¨â€</li>
</ul>
<h2 id="how">Howï¼ˆå¦‚ä½•é‡ç°ï¼‰</h2>
<p>ä¸‹é¢ç»™ä¸€ä¸ªâ€œæœ€å°å¤ç°æ€è·¯â€ã€‚å®ƒä¸æ˜¯ä¸ºäº†å†™å‡ºæœ€çŸ­ä»£ç ï¼Œè€Œæ˜¯ä¸ºäº†æŠŠè§¦å‘æ¡ä»¶è¯´æ¸…æ¥šã€‚</p>
<h3 id="1clone-config-session-ticket-keys">å¤ç° 1ï¼š<code>Clone()</code> åä¸åŒ Config å…±äº« session ticket keys</h3>
<p>å‰æï¼š</p>
<ul>
<li>æœåŠ¡ç«¯ä½¿ç”¨ <code>tls.Config</code>ï¼Œä½†<strong>ä¸æ˜¾å¼è®¾ç½®</strong> <code>SessionTicketKey</code>ï¼Œä¹Ÿä¸è°ƒç”¨ <code>SetSessionTicketKeys</code>ï¼ˆè®© Go è‡ªåŠ¨ç”Ÿæˆ ticket keysï¼‰</li>
<li>å…ˆç”¨ Config A è·‘è¿‡ä¸€æ¬¡æ¡æ‰‹ï¼ˆè§¦å‘è‡ªåŠ¨ç”Ÿæˆ keysï¼‰</li>
<li>ç„¶åå¯¹ Config A è°ƒç”¨ <code>Clone()</code> å¾—åˆ° Config B</li>
</ul>
<p>æ­¥éª¤ï¼ˆæ¦‚å¿µç‰ˆï¼‰ï¼š</p>
<ol>
<li>ç”¨ Config A å¯ä¸€ä¸ª TLS serverï¼ˆç«¯å£ 8443ï¼‰</li>
<li>å®¢æˆ·ç«¯è¿æ¥ä¸€æ¬¡ï¼Œæ‹¿åˆ° sessionï¼ˆå®¢æˆ·ç«¯å¼€å¯ <code>ClientSessionCache</code>ï¼‰</li>
<li>æœåŠ¡ç«¯å¯¹â€œå·²ç»ç”¨è¿‡çš„ Config Aâ€åš <code>Clone()</code> å¾—åˆ° Config Bï¼Œå¹¶ç”¨ Config B å†èµ·ä¸€ä¸ª TLS serverï¼ˆç«¯å£ 9443ï¼‰ï¼ŒåŒæ—¶è®© Config B æ”¹ä¸€äº›ä½ å¸Œæœ›éš”ç¦»çš„ç­–ç•¥ï¼ˆä¾‹å¦‚ä¸åŒçš„ <code>ClientAuth</code> / ä¸åŒçš„è¯ä¹¦é“¾ç­‰ï¼‰</li>
<li>å®¢æˆ·ç«¯æ”¹è¿ 9443ï¼Œå¹¶å°è¯• session resumptionï¼ˆåŒä¸€ä¸ª <code>ClientSessionCache</code>ï¼‰</li>
<li>åœ¨ä¿®å¤å‰ï¼Œä½ å¯èƒ½ä¼šè§‚å¯Ÿåˆ°ï¼š<strong>åœ¨ä½ ä»¥ä¸ºâ€œæ¢äº† Config/æ¢äº†ç­–ç•¥â€åï¼Œsession ä»ç„¶è¢«æ¢å¤</strong></li>
</ol>
<p>ç¤ºä¾‹ä»£ç éª¨æ¶ï¼ˆåªå±•ç¤ºå…³é”®ç‚¹ï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">// å…³é”®ç‚¹ï¼š</span>
<span class="c1">// - serverConfigA ä¸è®¾ç½® SessionTicketKey / ä¸è°ƒç”¨ SetSessionTicketKeys</span>
<span class="c1">// - å…ˆè®© A è¢«ç”¨è¿‡ï¼ˆå®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼‰</span>
<span class="c1">// - å† Clone() å¾—åˆ° B</span>
<span class="c1">// - client ä½¿ç”¨ ClientSessionCacheï¼Œç¬¬äºŒæ¬¡è¿æ¥æ—¶æ‰å¯èƒ½ resumption</span>
</code></pre></div>

<h3 id="2_1">å¤ç° 2ï¼šå®Œæ•´è¯ä¹¦é“¾è¿‡æœŸä¸ç”Ÿæ•ˆï¼ˆæœåŠ¡ç«¯ä»æ¢å¤ä¼šè¯ï¼‰</h3>
<p>è¿™ä¸ªå¤ç°æ›´ä¾èµ–è¯ä¹¦é“¾æ„é€ ï¼ˆæ¯”å¦‚è®©ä¸€ä¸ª intermediate åœ¨è¾ƒçŸ­æ—¶é—´å†…è¿‡æœŸï¼‰ï¼Œæ€è·¯æ˜¯ï¼š</p>
<ol>
<li>æ„é€ ä¸€æ¡åŒ…å«ä¸­é—´è¯ä¹¦çš„é“¾ï¼ˆleaf + intermediate + rootï¼‰</li>
<li>å»ºç«‹ä¸€æ¬¡æ¡æ‰‹å¹¶è®©å®¢æˆ·ç«¯æ‹¿åˆ°å¯æ¢å¤çš„ session</li>
<li>ç­‰ intermediateï¼ˆæˆ– rootï¼‰è¿‡æœŸ</li>
<li>å†æ¬¡è¿æ¥ï¼Œè§‚å¯ŸæœåŠ¡ç«¯æ˜¯å¦ä»å…è®¸ session resumption</li>
</ol>
<p>åœ¨ä¿®å¤å‰ï¼ŒæœåŠ¡ç«¯å¯èƒ½åªæ£€æŸ¥ leaf çš„æœ‰æ•ˆæœŸï¼Œä»è€Œå¿½ç•¥é“¾æ¡çš„è¿‡æœŸã€‚</p>
<h2 id="how_1">Howï¼ˆå¦‚ä½•ä¿®å¤ä¸é¿å…ï¼‰</h2>
<h3 id="_1">å®˜æ–¹ä¿®å¤ï¼ˆå»ºè®®ä¼˜å…ˆåšï¼‰</h3>
<p>æ ¹æ® issue æè¿°ï¼ŒGo çš„ä¿®å¤ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>Config.Clone</code> <strong>ä¸å†å¤åˆ¶è‡ªåŠ¨ç”Ÿæˆçš„ session ticket keys</strong>ï¼ˆä½†ä»ä¼šå¤åˆ¶ä½ æ˜¾å¼æä¾›çš„ keysï¼‰</li>
<li>æœåŠ¡ç«¯ session resumption åˆ¤æ–­æ—¶ï¼Œ<strong>æŠŠå®Œæ•´è¯ä¹¦é“¾çš„è¿‡æœŸçº³å…¥è€ƒè™‘</strong></li>
</ul>
<p>æœ€ç›´æ¥çš„å»ºè®®å°±æ˜¯ï¼š<strong>å‡çº§ Go ç‰ˆæœ¬åˆ° Go 1.25.7 ä»¥ä¸Š</strong>ï¼ˆæˆ–æ›´é«˜ç‰ˆæœ¬çº¿ä¸­å·²åŒ…å«è¯¥ä¿®å¤çš„ç‰ˆæœ¬ï¼‰ã€‚è¿™ä¸€ç‚¹å¯ä»¥ä» Go çš„ backport issue é‡Œçœ‹åˆ°è¯¥ä¿®å¤è¢«çº³å…¥ 1.25 åˆ†æ”¯å‘å¸ƒèŠ‚å¥ï¼ˆè§ Referencesï¼‰ã€‚</p>
<h3 id="_2">åœ¨å‡çº§å‰çš„è§„é¿æ‰‹æ®µï¼ˆå·¥ç¨‹ä¾§èƒ½åšçš„ï¼‰</h3>
<ol>
<li><strong>ä¸è¦æŠŠâ€œè‡ªåŠ¨ç”Ÿæˆçš„ ticket keysâ€å½“ä½œéš”ç¦»è¾¹ç•Œ</strong></li>
<li>
<p>å¦‚æœä½ æœ‰å¤šä¸ª <code>tls.Config</code>ï¼Œå¹¶ä¸”å¸Œæœ›å®ƒä»¬çš„ session resumption äº’ç›¸éš”ç¦»ï¼šè¯·æ˜¾å¼è®¾ç½®å„è‡ªçš„ ticket keysã€‚</p>
</li>
<li>
<p><strong>æ˜¾å¼ç®¡ç† session ticket keysï¼ˆå¹¶ä¸”æŒ‰ Config åšéš”ç¦»ï¼‰</strong></p>
</li>
<li>ç”¨ <code>Config.SetSessionTicketKeys(...)</code> æˆ– <code>Config.SessionTicketKey</code>ï¼ˆå¦‚ä½ é¡¹ç›®ä»åœ¨ç”¨ï¼‰æ˜¾å¼é…ç½® keysï¼Œå¹¶ç¡®ä¿ä¸åŒ Config ä¸å…±äº«åŒä¸€å¥— keysã€‚</li>
<li>
<p>å¦‚æœä½ ç¡®å®æƒ³å…±äº«ï¼ˆæ¯”å¦‚å¤šå®ä¾‹è¦å…±äº«ä¼šè¯æ¢å¤èƒ½åŠ›ï¼‰ï¼Œé‚£å°±å…±äº«å¾—â€œæ˜æ˜ç™½ç™½â€ï¼Œå¹¶æŠŠé£é™©å†™è¿›è®¾è®¡æ–‡æ¡£ã€‚</p>
</li>
<li>
<p><strong>éœ€è¦å¼ºéš”ç¦»æ—¶ï¼Œç›´æ¥ç¦ç”¨ session tickets</strong></p>
</li>
<li>
<p>å¯¹å®‰å…¨è¾¹ç•Œæ•æ„Ÿçš„åœºæ™¯ï¼Œå¯ä»¥è®¾ç½® <code>Config.SessionTicketsDisabled = true</code>ï¼Œç”¨ä¸€æ¬¡å®Œæ•´æ¡æ‰‹æ¢å–æ›´æ¸…æ™°çš„éš”ç¦»è¯­ä¹‰ã€‚</p>
</li>
<li>
<p><strong>æŠŠè¯ä¹¦é“¾ç”Ÿå‘½å‘¨æœŸçº³å…¥ä½ çš„â€œä¼šè¯æ¢å¤ç­–ç•¥â€</strong></p>
</li>
<li>å¦‚æœä½ å¯¹è¯ä¹¦é“¾è¿‡æœŸéå¸¸æ•æ„Ÿï¼Œå»ºè®®åœ¨å‡çº§å‰å…ˆè¯„ä¼°ï¼šæ˜¯å¦éœ€è¦ä¸»åŠ¨ç¼©çŸ­ä¼šè¯ç¥¨æ®æœ‰æ•ˆçª—å£ã€æˆ–åœ¨è¯ä¹¦é“¾è½®æ¢æ—¶ä¸»åŠ¨å¤±æ•ˆæ—§ sessionï¼ˆå¦åˆ™ resumption çš„è¡Œä¸ºå¾ˆéš¾æŒ‰â€œè¯ä¹¦è¿‡æœŸâ€ç›´è§‰æ¨æ–­ï¼‰ã€‚</li>
</ol>
<h2 id="image-binary-cve-2025-68121">æ£€æµ‹ï¼šå¦‚ä½•æ£€æŸ¥ image / binary æ˜¯å¦åŒ…å« CVE-2025-68121</h2>
<p>é™¤äº†â€œå‡çº§ Goâ€ï¼Œä½ é€šå¸¸è¿˜éœ€è¦å›ç­”å¦ä¸€ä¸ªæ›´è½åœ°çš„é—®é¢˜ï¼š<strong>æˆ‘çš„ Docker image / çº¿ä¸ŠäºŒè¿›åˆ¶ï¼Œåˆ°åº•æœ‰æ²¡æœ‰å¸¦ç€è¿™ä¸ª CVEï¼Ÿ</strong></p>
<p>ä¸‹é¢æ˜¯å‡ ç§å¸¸è§å·¥å…·çš„å¯¹æ¯”ï¼ˆæŒ‰ä½ ç»™çš„è¡¨æ•´ç†ï¼‰ï¼š</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th align="right">Detects CVE-2025-68121</th>
<th align="right">Works on binary</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Trivy</td>
<td align="right">âœ”</td>
<td align="right">âœ”</td>
<td>å®¹å™¨/æ–‡ä»¶ç³»ç»Ÿ/äºŒè¿›åˆ¶éƒ½å¸¸ç”¨ï¼Œç”Ÿæ€æœ€å¹¿</td>
</tr>
<tr>
<td>Grype</td>
<td align="right">âœ”</td>
<td align="right">âœ”</td>
<td>è¦†ç›–é¢å¹¿ï¼Œæ‰« image/dir/SBOM éƒ½é¡ºæ‰‹</td>
</tr>
<tr>
<td>CVE Binary Tool</td>
<td align="right">ğŸ‘</td>
<td align="right">âœ”</td>
<td>å¯¹ Go runtime çš„è¦†ç›–ç›¸å¯¹æœ‰é™ï¼Œæ›´å¤šåœºæ™¯æ˜¯â€œèƒ½æ‰«ä½†ä¸ä¸€å®šå‡†â€</td>
</tr>
<tr>
<td>govulncheck</td>
<td align="right">âœ”</td>
<td align="right">âŒ</td>
<td>æ›´é€‚åˆæ‰«æºç /ä¾èµ–ï¼ˆsource code analysisï¼‰ï¼Œä¸æ˜¯æ‹¿æ¥æ‰«äº§ç‰©çš„</td>
</tr>
<tr>
<td>Manual Version Check</td>
<td align="right">âœ”ï¼ˆheuristicï¼‰</td>
<td align="right">âœ”</td>
<td>çœ‹ binary é‡ŒåµŒå…¥çš„ Go ç‰ˆæœ¬å·ï¼Œç®€å•ä½†ä¸ç»å¯¹</td>
</tr>
</tbody>
</table>
<p>ä½ è¯´å®é™…ç”¨ä¸‹æ¥æ›´æ¨è <strong>Grype</strong>ï¼Œç”¨å®ƒé€‚åˆä½œä¸º CI / é•œåƒå‘å¸ƒå‰çš„â€œå®ˆé—¨å‘˜â€ã€‚</p>
<h2 id="grype">Grype ä»‹ç»ä¸ç”¨æ³•ï¼ˆæˆ‘æ¨èï¼‰</h2>
<p>Grype æ˜¯ Anchore å¼€æºçš„æ¼æ´æ‰«æå™¨ï¼Œä¸»æ‰“ <strong>container images / filesystems / SBOMs</strong>ï¼ˆä¸‰ç±»ç›®æ ‡éƒ½èƒ½æ‰«ï¼‰ã€‚é¡¹ç›®ä¸»é¡µè§ï¼š<code>https://github.com/anchore/grype</code>ã€‚</p>
<h3 id="1">1) å®‰è£…</h3>
<p>å®˜æ–¹å®‰è£…æ–¹å¼é‡Œï¼Œæˆ‘å¸¸ç”¨è¿™ä¸¤ä¸ªï¼ˆmacOS/CI éƒ½é¡ºæ‰‹ï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># å®˜æ–¹å®‰è£…è„šæœ¬ï¼ˆLinux/macOS/Windowsï¼‰</span>
curl<span class="w"> </span>-sSfL<span class="w"> </span>https://get.anchore.io/grype<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>sh<span class="w"> </span>-s<span class="w"> </span>--<span class="w"> </span>-b<span class="w"> </span>/usr/local/bin

<span class="c1"># Homebrewï¼ˆmacOSï¼‰</span>
brew<span class="w"> </span>tap<span class="w"> </span>anchore/grype
brew<span class="w"> </span>install<span class="w"> </span>grype
</code></pre></div>

<h3 id="2-docker-image">2) æœ€å¸¸ç”¨ï¼šæ‰« Docker image</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># æ‰«æœ¬åœ° docker daemon é‡Œçš„ image</span>
grype<span class="w"> </span>alpine:latest

<span class="c1"># ç›´æ¥ä» registry æ‹‰ï¼ˆä¸ä¾èµ–æœ¬åœ°å®¹å™¨è¿è¡Œæ—¶ï¼‰</span>
grype<span class="w"> </span>registry:yourrepo/yourimage:tag
</code></pre></div>

<p>å¸¸ç”¨å‚æ•°ï¼ˆæ›´é€‚åˆ CIï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># åªçœ‹æœ‰ä¿®å¤ç‰ˆæœ¬ï¼ˆfixedï¼‰çš„æ¼æ´ï¼Œé™ä½å™ªéŸ³</span>
grype<span class="w"> </span>yourimage:tag<span class="w"> </span>--only-fixed

<span class="c1"># è¾“å‡ºä¸º table/json/sarif ç­‰</span>
grype<span class="w"> </span>yourimage:tag<span class="w"> </span>-o<span class="w"> </span>table
grype<span class="w"> </span>yourimage:tag<span class="w"> </span>-o<span class="w"> </span>json

<span class="c1"># è‹¥å‘ç° &gt;= high çš„æ¼æ´ï¼Œç›´æ¥è®©å‘½ä»¤è¿”å›é 0ï¼ˆç”¨äº CI é˜»æ–­ï¼‰</span>
grype<span class="w"> </span>yourimage:tag<span class="w"> </span>--fail-on<span class="w"> </span>high
</code></pre></div>

<h3 id="3">3) æ‰«ç›®å½• / æ‰«å•ä¸ªæ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶ï¼‰</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># æ‰«ç›®å½•</span>
grype<span class="w"> </span>dir:/path/to/rootfs

<span class="c1"># æ‰«å•ä¸ªæ–‡ä»¶ï¼ˆæ¯”å¦‚æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼‰</span>
grype<span class="w"> </span>file:/path/to/your-binary
</code></pre></div>

<p>è¯´æ˜ï¼š</p>
<ul>
<li>å¯¹â€œäºŒè¿›åˆ¶â€çš„è¯†åˆ«èƒ½åŠ›ï¼Œå–å†³äº Grype çš„åŒ…è¯†åˆ«ä¸æ•°æ®åº“åŒ¹é…èƒ½åŠ›ï¼›åœ¨å¾ˆå¤šå›¢é˜Ÿé‡Œï¼Œæ›´ç¨³çš„è·¯çº¿æ˜¯ <strong>å…ˆå‡º SBOMï¼Œå†æ‰« SBOM</strong>ï¼ˆè§ä¸‹ä¸€èŠ‚ï¼‰ã€‚</li>
</ul>
<p>è¿™é‡Œçš„ <strong>SBOM</strong> æ˜¯ <em>Software Bill of Materials</em>ï¼Œå¯ä»¥ç†è§£æˆâ€œè½¯ä»¶ç‰©æ–™æ¸…å•â€ï¼šæŠŠä¸€ä¸ªé•œåƒ/æ–‡ä»¶ç³»ç»Ÿ/æ„å»ºäº§ç‰©é‡ŒåŒ…å«çš„ç»„ä»¶ï¼ˆOS åŒ…ã€è¯­è¨€ä¾èµ–ã€ç‰ˆæœ¬ã€PURL/CPE ç­‰æ ‡è¯†ï¼‰ç»“æ„åŒ–åˆ—å‡ºæ¥ã€‚<br>
å…ˆç”Ÿæˆ SBOM å†åšæ¼æ´åŒ¹é…ï¼Œé€šå¸¸æ›´ç¨³ã€æ›´å¿«ï¼Œä¹Ÿæ›´å®¹æ˜“åœ¨ CI é‡Œå¤ç°ä¸å¯¹æ¯”ï¼ˆä½ æ‰«çš„ç›®æ ‡ä¸å†æ˜¯â€œæŸä¸ªä¸å¯è§çš„æ–‡ä»¶é›†åˆâ€ï¼Œè€Œæ˜¯ä¸€ä»½æ˜ç¡®çš„æ¸…å•ï¼‰ã€‚</p>
<p>ä¸€ä¸ªæç®€çš„ SBOM é•¿è¿™æ ·ï¼ˆä»¥ CycloneDX JSON ä¸ºä¾‹ï¼ŒçœŸå®æ–‡ä»¶ä¼šæ›´é•¿ï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;bomFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CycloneDX&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;specVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.5&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;component&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;container&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;example/app&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;components&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;library&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;golang.org/x/crypto&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;v0.18.0&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;purl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pkg:golang/golang.org/x/crypto@v0.18.0&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;library&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;github.com/anchore/grype&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;v0.104.1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;purl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pkg:golang/github.com/anchore/grype@v0.104.1&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="4-sbom">4) æ›´ç¨³æ›´å¿«ï¼šæ‰« SBOM</h3>
<p>å…ˆè¯´â€œæ€ä¹ˆç”Ÿæˆ SBOMâ€ã€‚æˆ‘æ¨èç”¨ Syftï¼ˆåŒæ ·æ˜¯ Anchore çš„å·¥å…·ï¼‰ï¼Œå®ƒèƒ½å¯¹ image / dir / file ç”Ÿæˆå¤šç§æ ¼å¼çš„ SBOMï¼Œæœ€å¸¸è§çš„æ˜¯ CycloneDX å’Œ SPDXã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># å®‰è£… Syftï¼ˆå®˜æ–¹è„šæœ¬ï¼‰</span>
curl<span class="w"> </span>-sSfL<span class="w"> </span>https://get.anchore.io/syft<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>sh<span class="w"> </span>-s<span class="w"> </span>--<span class="w"> </span>-b<span class="w"> </span>/usr/local/bin

<span class="c1"># macOS ä¹Ÿå¯ä»¥ç”¨ Homebrew</span>
brew<span class="w"> </span>install<span class="w"> </span>syft

<span class="c1"># 1) ç»™é•œåƒç”Ÿæˆ SBOMï¼ˆCycloneDX JSONï¼‰</span>
syft<span class="w"> </span>yourimage:tag<span class="w"> </span>-o<span class="w"> </span>cyclonedx-json<span class="o">=</span>sbom.json

<span class="c1"># 2) ç»™ç›®å½•/rootfs ç”Ÿæˆ SBOM</span>
syft<span class="w"> </span>dir:/path/to/rootfs<span class="w"> </span>-o<span class="w"> </span>cyclonedx-json<span class="o">=</span>sbom.json

<span class="c1"># 3) ç»™å•ä¸ªäºŒè¿›åˆ¶ç”Ÿæˆ SBOM</span>
syft<span class="w"> </span>file:/path/to/your-binary<span class="w"> </span>-o<span class="w"> </span>cyclonedx-json<span class="o">=</span>sbom.json
</code></pre></div>

<p>ç”Ÿæˆå‡ºæ¥çš„ <code>sbom.json</code> å†äº¤ç»™ Grype æ‰«ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ç›´æ¥æ‰«ä¸€ä¸ª Syft JSONï¼ˆSBOMï¼‰</span>
grype<span class="w"> </span>sbom:./sbom.json

<span class="c1"># æˆ–è€…æŠŠ SBOM ä» stdin pipe è¿›å»</span>
cat<span class="w"> </span>./sbom.json<span class="w"> </span><span class="p">|</span><span class="w"> </span>grype
</code></pre></div>

<h3 id="5">5) ä¸€äº›æˆ‘å¸¸ç”¨çš„â€œéå¿…éœ€ä½†å¥½ç”¨â€çš„å‚æ•°</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># ç»“æœå°½é‡æŒ‰ CVE èšåˆï¼ˆèƒ½è½¬æˆ CVE æ—¶ï¼‰</span>
grype<span class="w"> </span>yourimage:tag<span class="w"> </span>--by-cve

<span class="c1"># æ‰«å…¨å±‚ï¼ˆall-layersï¼‰è€Œä¸åªæ˜¯ squashedï¼ˆæ›´ä¸¥æ ¼ï¼Œä½†ç»“æœå¯èƒ½æ›´å¤šï¼‰</span>
grype<span class="w"> </span>yourimage:tag<span class="w"> </span>--scope<span class="w"> </span>all-layers

<span class="c1"># å¯¹ç¼º CPE çš„åŒ…å°è¯•ç”Ÿæˆ CPEï¼ˆæœ‰æ—¶èƒ½è¡¥é½åŒ¹é…ï¼‰</span>
grype<span class="w"> </span>yourimage:tag<span class="w"> </span>--add-cpes-if-none

<span class="c1"># æ›´æ–° vulnerability DBï¼ˆæ’æŸ¥â€œä¸ºå•¥æ‰«ä¸å‡ºæŸä¸ª CVEâ€æ—¶å¾ˆæœ‰ç”¨ï¼‰</span>
grype<span class="w"> </span>db<span class="w"> </span>update
</code></pre></div>

<h2 id="cve-2025-68121">æ—¶åºå›¾ï¼šCVE-2025-68121 çš„è§¦å‘æµç¨‹ï¼ˆæ¦‚å¿µå›¾ï¼‰</h2>
<div class="highlight"><pre><span></span><code>@startuml
title CVE-2025-68121 (crypto/tls): Session Resumption Pitfalls

actor Client
participant &quot;Server (Config A)\n(no explicit ticket keys)&quot; as SrvA
participant &quot;Config.Clone()&quot; as Clone
participant &quot;Server (Config B)\n(mutated policy/certs)&quot; as SrvB
participant &quot;PKI Chain\n(leaf + intermediate + root)&quot; as Chain

== Issue 1: Config.Clone copies auto-generated ticket keys ==

Client -&gt; SrvA: 1) Full handshake (TLS)\n(session tickets enabled)
note right of SrvA
If SessionTicketKey is not set and
SetSessionTicketKeys not called,
crypto/tls auto-generates &amp; rotates
session ticket keys.
end note
SrvA --&gt; Client: SessionTicket (encrypted with auto keys)

SrvA -&gt; Clone: 2) Clone used Config A\n( AFTER handshake )
Clone --&gt; SrvB: Config B contains\ncopied auto ticket keys (pre-fix)
note right of SrvB
Unexpected: Config A and Config B
share the same ticket keys.
end note

Client -&gt; SrvB: 3) Connect to B\n(with cached session)
SrvB --&gt; Client: Session resumption succeeds\n(should be isolated by policy)

== Issue 2: Resumption checks leaf only (pre-fix) ==

note over Client,SrvB
Assume the original handshake used a certificate chain.
Later, an intermediate/root expires.
end note

Client -&gt; Chain: 4) Time passes\nintermediate/root expires
Client -&gt; SrvB: 5) Resume session
SrvB -&gt; Chain: Validate for resumption\n(pre-fix: leaf only)
Chain --&gt; SrvB: leaf OK, chain expired
SrvB --&gt; Client: Resumption allowed\n(should fail if full chain checked)

== Fixed behavior (expected) ==
note over SrvB
- Clone() does NOT copy auto ticket keys
  (only explicitly set keys are copied)
- Resumption checks full certificate chain expiry
end note
@enduml
</code></pre></div>

<p><img alt="æ—¶åºå›¾" src="../images/tech_20260225_cve_68121_sequence.png"></p>
<h2 id="summary-map">æ€ç»´å¯¼å›¾ï¼šå…¨æ–‡è¦ç‚¹ï¼ˆSummary Mapï¼‰</h2>
<div class="highlight"><pre><span></span><code>@startmindmap
&lt;style&gt;
mindmapDiagram {
  node { BackgroundColor #FAFAFA }
  :depth(0) { BackgroundColor #FFD700 }
  :depth(1) { BackgroundColor #E3F2FD }
  :depth(2) { BackgroundColor #F5F5F5 }
}
&lt;/style&gt;
* CVE-2025-68121\nGo crypto/tls
** What
*** Clone å¤åˆ¶è‡ªåŠ¨ç”Ÿæˆ ticket keys\n(è·¨ Config å…±äº«)
*** Resumption åªæ£€æŸ¥ leaf\n(å¿½ç•¥å®Œæ•´é“¾è¿‡æœŸ)
** Why / Impact
*** é…ç½®éš”ç¦»è¯­ä¹‰è¢«å‰Šå¼±
*** è¯ä¹¦é“¾è¿‡æœŸç­–ç•¥è¢«ç»•å¼€\n(å®¡è®¡/åˆè§„é£é™©)
** Repro (æ€è·¯)
*** Config A æ¡æ‰‹ç”Ÿæˆ keys
*** Clone(A)-&gt;B å¹¶ä¿®æ”¹ç­–ç•¥
*** Client ç”¨ cache è¿æ¥ B\nè§‚å¯Ÿæ˜¯å¦ resumption
*** æ„é€ é“¾ + intermediate è¿‡æœŸ\nè§‚å¯Ÿæ˜¯å¦ä»å¯æ¢å¤
** Fix / Avoid
*** å‡çº§ Go &gt;= 1.25.7
*** æ˜¾å¼éš”ç¦» ticket keys\n(SetSessionTicketKeys)
*** å¼ºéš”ç¦»ï¼šç¦ç”¨ tickets\n(SessionTicketsDisabled)
*** è¯ä¹¦é“¾è½®æ¢/è¿‡æœŸ\nç»“åˆ session ç”Ÿå‘½å‘¨æœŸè¯„ä¼°
** Detect (æ¨è Grype)
*** æ‰« image/dir/file
*** æ›´ç¨³ï¼šSBOM â†’ scan SBOM
**** Syft ç”Ÿæˆ SBOM\n(CycloneDX/SPDX)
**** Grype æ‰« sbom.json
** References
*** Go issues: 77113 / 77115
*** Anchore: Grype / Syft
@endmindmap
</code></pre></div>

<p><img alt="æ€ç»´å¯¼å›¾" src="../images/tech_20260225_cve_68121_mindmap.png"></p>
<h2 id="summary">Summary</h2>
<ul>
<li><strong>é—®é¢˜ 1</strong>ï¼š<code>Config.Clone</code> å¤åˆ¶è‡ªåŠ¨ç”Ÿæˆçš„ session ticket keys â†’ å¤šä¸ª <code>tls.Config</code> ä¹‹é—´æ„å¤–å…±äº«ç¥¨æ® key â†’ session resumption çš„éš”ç¦»è¾¹ç•Œè¢«å‰Šå¼±ã€‚</li>
<li><strong>é—®é¢˜ 2</strong>ï¼šæœåŠ¡ç«¯æ¢å¤ä¼šè¯åªæ£€æŸ¥ leaf è¯ä¹¦ â†’ é“¾æ¡ä¸­é—´/æ ¹è¯ä¹¦è¿‡æœŸæ—¶ï¼Œä»å¯èƒ½æ¢å¤ä¼šè¯ã€‚</li>
<li><strong>é¦–é€‰ä¿®å¤</strong>ï¼šå‡çº§åˆ°åŒ…å« CVE-2025-68121 ä¿®å¤çš„ Go ç‰ˆæœ¬ã€‚</li>
<li><strong>å·¥ç¨‹è§„é¿</strong>ï¼šæ˜¾å¼é…ç½®å¹¶éš”ç¦» ticket keysï¼›å¿…è¦æ—¶ç¦ç”¨ session ticketsï¼›æŠŠè¯ä¹¦é“¾è¿‡æœŸä¸ session ç”Ÿå‘½å‘¨æœŸä¸€èµ·è€ƒè™‘ã€‚</li>
</ul>
<h2 id="checklist">Checklist</h2>
<ul>
<li>[ ] ç›˜ç‚¹æœåŠ¡ç«¯æ˜¯å¦è°ƒç”¨ <code>Config.Clone()</code>ï¼ˆå°¤å…¶æ˜¯å¯¹â€œå·²ç”¨äºæ¡æ‰‹çš„ Configâ€åš Clone çš„åœºæ™¯ï¼‰</li>
<li>[ ] ç›˜ç‚¹æ˜¯å¦ä¾èµ–å¤šä¸ª <code>tls.Config</code> çš„â€œéš”ç¦»â€è¯­ä¹‰ï¼ˆç«¯å£/ç§Ÿæˆ·/ç­–ç•¥/è¯ä¹¦é“¾ï¼‰</li>
<li>[ ] æ˜¯å¦æ˜¾å¼é…ç½®äº† session ticket keysï¼ˆ<code>SetSessionTicketKeys</code> / <code>SessionTicketKey</code>ï¼‰ï¼Œå¹¶ç¡®ä¿ä¸åŒ Config ä¸æ„å¤–å…±äº«</li>
<li>[ ] æ˜¯å¦éœ€è¦ <code>SessionTicketsDisabled</code>ï¼ˆå®‰å…¨è¾¹ç•Œä¼˜å…ˆçš„ç³»ç»Ÿï¼‰</li>
<li>[ ] å‡çº§ Go ç‰ˆæœ¬å¹¶éªŒè¯ï¼šsession resumption è¡Œä¸ºæ˜¯å¦ç¬¦åˆé¢„æœŸï¼ˆå«è¯ä¹¦é“¾è½®æ¢/è¿‡æœŸåœºæ™¯ï¼‰</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/golang/go/issues/77113">Go issue #77113: crypto/tls Config.Clone + session resumption (CVE-2025-68121)</a></li>
<li><a href="https://golang.org/issue/77115">Go issue #77115: CVE-2025-68121 1.25 backport tracking</a></li>
<li><a href="https://github.com/anchore/grype">Grype (Anchore): vulnerability scanner for images/filesystems/SBOMs</a></li>
<li><a href="https://oss.anchore.com/docs/installation/grype/">Installing Grype (Anchore OSS docs)</a></li>
<li><a href="https://oss.anchore.com/docs/reference/grype/cli/">Grype CLI reference (Anchore OSS docs)</a></li>
<li><a href="https://github.com/anchore/syft">Syft (Anchore): SBOM generator</a></li>
</ul>
<hr/>
<p>æœ¬ä½œå“é‡‡ç”¨<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯ã€‚</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/go.html">go</a>
      <a href="./tag/security.html">security</a>
      <a href="./tag/tls.html">tls</a>
      <a href="./tag/cve.html">cve</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="./she-ji-yi-ge-xue-xi-zhi-chang-ying-yu-de-ai-agentllm-agent-jia-gou-ri-chang-bi-huan-da-fen.html" title="è®¾è®¡ä¸€ä¸ªå­¦ä¹ èŒåœºè‹±è¯­çš„ AI Agentï¼ˆLLM Agent æ¶æ„ + æ—¥å¸¸é—­ç¯ + æ‰“åˆ†ï¼‰">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="./zhi-chang-gong-ju-xiang-zhi-xiang-shang-guan-li-bu-shi-pai-ma-pi-er-shi-bang-ling-dao-zuo-jue-ce-geng-rong-yi.html" title="èŒåœºå·¥å…·ç®±ä¹‹å‘ä¸Šç®¡ç†ï¼šä¸æ˜¯æ‹é©¬å±ï¼Œè€Œæ˜¯å¸®é¢†å¯¼åšå†³ç­–æ›´å®¹æ˜“">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="./debug-build-de-liang-chong-zhe-xue-c-hong-vs-go-lian-jie-qi-zhu-ru.html">Debug Build çš„ä¸¤ç§å“²å­¦ï¼šC++ å® vs Go é“¾æ¥å™¨æ³¨å…¥</a></li>
      <li><a href="./go-wei-fu-wu-fang-wen-kong-zhi-zhi-casbin-shi-jian-zhi-nan.html">Go å¾®æœåŠ¡è®¿é—®æ§åˆ¶ä¹‹ Casbin å®è·µæŒ‡å—</a></li>
      <li><a href="./tong-guo-tong-xin-lai-gong-xiang-nei-cun-er-bu-shi-tong-guo-gong-xiang-nei-cun-lai-tong-xin.html">é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜, è€Œä¸æ˜¯é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡</a></li>
      <li><a href="./go-yu-yan-de-chang-jian-xian-jing.html">go è¯­è¨€çš„å¸¸è§é™·é˜±</a></li>
      <li><a href="./bian-che-mo-shi-de-xie-yi-she-ji.html">è¾¹è½¦æ¨¡å¼çš„åè®®è®¾è®¡</a></li>
    </ul>
  </div>



<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'wfblog';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

<footer>
<p>&copy; 2010 ~ 2030  Walter Fan <a href="https://beian.miit.gov.cn" target="_blank">çš–ICPå¤‡20001876å·-1</a></p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><!-- StatusCake -->

<!-- End StatusCake --></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Walter Fan's Blog ",
  "url" : ".",
  "image": "./images/walterfan.jpg",
  "description": "an old programmer never die, he just branch to a new address."
}
</script>
</body>
</html>