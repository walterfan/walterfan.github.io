
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="./theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">




    <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="./images/favicon.ico" type="image/x-icon">



<meta name="author" content="Walter Fan" />
<meta name="description" content="Daily minute" />
<meta name="keywords" content="journal, blog">


<meta property="og:site_name" content="Walter Fan's Blog"/>
<meta property="og:title" content="Journal on 2020-02-12"/>
<meta property="og:description" content="Daily minute"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./journal-on-2020-02-12.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-02-12 10:20:00+08:00"/>
<meta property="article:modified_time" content="2020-02-12 19:30:00+08:00"/>
<meta property="article:author" content="./author/walter-fan.html">
<meta property="article:section" content="Journal"/>
<meta property="article:tag" content="journal"/>
<meta property="article:tag" content="blog"/>
<meta property="og:image" content="./images/walterfan.jpg">

  <title>Walter Fan's Blog &ndash; Journal on 2020-02-12</title>

</head>
<body>
  <aside>
    <div>
      <a href=".">
        <img src="./images/walterfan.jpg" alt="Walter Fan" title="Walter Fan">
      </a>
      <h1><a href=".">Walter Fan</a></h1>

<p>手握灵珠常奋笔, 心开天籁不吹箫</p>
      <nav>
        <ul class="list">


            <li><a target="_blank" href="/" >Blog</a></li>
            <li><a target="_blank" href="/wiki" >Wiki</a></li>
            <li><a target="_blank" href="/tao" >Tao</a></li>
            <li><a target="_blank" href="https://www.jianshu.com/u/e0b365801f48" >简书</a></li>
        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-weibo" href="http://weibo.com/fanyamin" target="_blank">
            <i class="fab fa-weibo">
            </i>
          </a></li>
          <li>
            <a  class="sc-douban" href="https://douban.com" target="_blank">
            <i class="fab fa-douban">
            </i>
          </a></li>
          <li>
            <a  class="sc-github" href="http://github.com/walterfan" target="_blank">
            <i class="fab fa-github">
            </i>
          </a></li>
      </ul>
    </div>


  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="journal-on-2020-02-12">Journal on 2020-02-12</h1>
    <p>
          Posted on Wed 12 February 2020 in <a href="./category/journal.html">Journal</a>


    </p>
  </header>


  <div>
    <h1>Tech Review</h1>
<p>Is it better to be alive and wrong or right and dead?</p>
<p>在软件系统中，答案当然是“好死不如赖活”</p>
<p>How to build fault-tolerant distributed system.</p>
<p>容错怎么做呢？ 方法很多，最常用的就是冗余，鸡蛋不要放在一个篮子里。</p>
<h1>Book Review</h1>
<p>说明文的原则： </p>
<ul>
<li>统一性：始终坚持一个主题，不要漫谈</li>
<li>连贯性：说清来龙去脉，不要本末倒置</li>
<li>突出性：突出重点，分清主次</li>
</ul>
<h1>Daily English</h1>
<p>Youth means a temperamental predominance of courage over timidity , of the appetite for adventure over the love of ease.</p>
<p>翻译一：青春意味着易于兴奋的勇气胜过胆小，对冒险的渴望胜过对轻松自在的热爱。</p>
<p>翻译二：青春意味着在气质上勇敢多于怯懦，冒险进取多于舒适苟安</p>
<p>孰优孰劣，显然易见</p>
<ul>
<li>
<p>temperamental 英  [ˌtemprəˈmentl]  美  [ˌtemprəˈmentl]
adj. 喜怒无常的；性情的；易兴奋的</p>
</li>
<li>
<p>predominance  英  [prɪˈdɒmɪnəns]  美  [prɪˈdɑːmɪnəns]
n. 优势；卓越</p>
</li>
<li>
<p>timidity 英  [tɪˈmɪdəti]   美  [tɪˈmɪdəti]
n. 胆怯，胆小；羞怯</p>
</li>
<li>
<p>appetite 英  [ˈæpɪtaɪt]   美  [ˈæpɪtaɪt]
n. 食欲；嗜好</p>
</li>
</ul>
<p>Nobody grows old merely by a number of years. We grow old by deserting our ideals.</p>
<p>人变老主要不是因为痴长几年，而是丧失了理想</p>
<ul>
<li>
<p>merely 英  [ˈmɪəli]   美  [ˈmɪrli]
adv. 仅仅，只不过；只是</p>
</li>
<li>
<p>desert  英  [(for v.) dɪ'zɜːt; (for n.) 'dezət]  美  [(for v.) dɪˈzɝ​t; (for n.) 'dɛzɚt]</p>
</li>
</ul>
<p>n. 沙漠，荒原；沉闷乏味的境况（或地区），冷清的地方；应得的赏罚（常用复数）
v. 遗弃；舍弃，离弃（某地方）；（士兵）擅离（部队）；逃走；开小差；放弃，撇下不管；背离，使失望；（感觉、品质或技艺）离开，丧失
adj. 沙漠的；荒凉的；被抛弃的</p>
<h1>How to setup moinmoin as your personal wiki</h1>
<h2>1. Download moinmoin and prepare environment</h2>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">epel</span><span class="o">-</span><span class="n">release</span> <span class="o">-</span><span class="n">y</span>

<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="k">static</span><span class="p">.</span><span class="n">moinmo</span><span class="p">.</span><span class="k">in</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">moin</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">9</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">zxvf</span> <span class="n">moin</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">9</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">moin</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">9</span><span class="p">.</span><span class="mi">10</span>
<span class="n">sudo</span> <span class="n">python</span> <span class="n">setup</span><span class="p">.</span><span class="n">py</span> <span class="n">install</span> <span class="c1">--force --record=install.log --prefix=&#39;/opt/moin&#39; --install-data=/usr</span>


<span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span>
<span class="n">sudo</span> <span class="n">cp</span> <span class="n">server</span><span class="o">/</span><span class="n">moin</span><span class="p">.</span><span class="n">wsgi</span> <span class="n">moin</span><span class="p">.</span><span class="n">wsgi</span>


<span class="n">vi</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span><span class="n">moin</span><span class="p">.</span><span class="n">wsgi</span>

<span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="k">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/opt/moin/lib/python2.7/site-packages/&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="k">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;/usr/share/moin/&#39;</span><span class="p">)</span>



<span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">moin</span>
<span class="n">sudo</span> <span class="n">cp</span> <span class="n">config</span><span class="o">/</span><span class="n">wikiconfig</span><span class="p">.</span><span class="n">py</span> <span class="n">wikiconfig</span><span class="p">.</span><span class="n">py</span>

<span class="n">sudo</span> <span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;s/Untitled Wiki/Walter Personal Wiki/&#39;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span><span class="n">wikiconfig</span><span class="p">.</span><span class="n">py</span>

<span class="n">sudo</span> <span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;/#superuser/a\    superuser = [u\&quot;admin\&quot;, ]&#39;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span><span class="n">wikiconfig</span><span class="p">.</span><span class="n">py</span>

<span class="n">sudo</span> <span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;$a\    log_reverse_dns_lookups = False&#39;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span><span class="n">wikiconfig</span><span class="p">.</span><span class="n">py</span>

<span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">nginx</span><span class="p">:</span><span class="n">nginx</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">moin</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">nginx</span><span class="p">:</span><span class="n">nginx</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">moin</span>
</pre></div>


<h2>2 Install nginx</h2>
<div class="highlight"><pre><span></span><span class="nt">Replace</span>
    <span class="nt">server_name</span>  <span class="nt">_</span><span class="o">;</span>
<span class="nt">with</span>
    <span class="nt">server_name</span>  <span class="nt">203</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">113</span><span class="p">.</span><span class="nc">1</span><span class="o">;</span>


<span class="nt">location</span> <span class="o">/</span> <span class="p">{</span>
    <span class="err">uwsgi_pass</span> <span class="n">unix</span><span class="p">:</span><span class="o">///</span><span class="n">run</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span><span class="n">moin</span><span class="o">.</span><span class="n">sock</span><span class="p">;</span>
    <span class="err">include</span> <span class="err">uwsgi_params</span><span class="p">;</span>
<span class="p">}</span>


<span class="nt">sudo</span> <span class="nt">nginx</span> <span class="nt">-t</span>
<span class="nt">sudo</span> <span class="nt">systemctl</span> <span class="nt">start</span> <span class="nt">nginx</span><span class="p">.</span><span class="nc">service</span>
<span class="nt">sudo</span> <span class="nt">systemctl</span> <span class="nt">enable</span> <span class="nt">nginx</span><span class="p">.</span><span class="nc">service</span>
</pre></div>


<p>cd /usr/share/moin/
sudo cp server/moin.wsgi moin.wsgi
Open the newly created config file using the vi text editor:
sudo vi /srv/share/moin/moin.wsgi</p>
<h2>3 Install and configure uWSGI</h2>
<p>Acting as a hub between the Nginx web server and a Python application, uWSGI is designed to produce best performance using the high-performance uWSGI protocol. Next, let's take a look at how to install and configure uWSGI for running MoinMoin.</p>
<p>1) Use pip to install uWSGI as follows:</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">python</span><span class="o">-</span><span class="n">devel</span> <span class="n">python</span><span class="o">-</span><span class="n">setuptools</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span> <span class="n">gcc</span>
<span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="c1">--upgrade pip</span>
<span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">uwsgi</span>


<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">uwsgi</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="n">nginx</span><span class="p">:</span><span class="n">nginx</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">uwsgi</span>


<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">moin</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="n">nginx</span><span class="p">:</span><span class="n">nginx</span> <span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">moin</span>
</pre></div>


<ul>
<li>create /usr/share/moin/uwsgi.ini</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">cat</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="n">EOF</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">tee</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span><span class="n">uwsgi</span><span class="p">.</span><span class="n">ini</span><span class="w"></span>
<span class="o">[</span><span class="n">uwsgi</span><span class="o">]</span><span class="w"></span>
<span class="n">uid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nginx</span><span class="w"></span>
<span class="n">gid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nginx</span><span class="w"></span>
<span class="n">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span><span class="n">moin</span><span class="p">.</span><span class="n">sock</span><span class="w"></span>
<span class="n">chmod</span><span class="o">-</span><span class="n">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">660</span><span class="w"></span>
<span class="n">logto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="nf">log</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">uwsgi</span><span class="p">.</span><span class="nf">log</span><span class="w"></span>


<span class="n">chdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">moin</span><span class="w"></span>
<span class="n">wsgi</span><span class="o">-</span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">moin</span><span class="o">/</span><span class="n">moin</span><span class="p">.</span><span class="n">wsgi</span><span class="w"></span>


<span class="n">master</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"></span>
<span class="n">processes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="nf">max</span><span class="o">-</span><span class="n">requests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="w"></span>
<span class="n">harakiri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="w"></span>
<span class="n">vacuum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"></span>
<span class="n">enable</span><span class="o">-</span><span class="n">threads</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"></span>
<span class="n">EOF</span><span class="w"></span>
</pre></div>


<ul>
<li>create /etc/systemd/system/uwsgi.service</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">cat</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="n">EOF</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">tee</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="k">system</span><span class="o">/</span><span class="n">uwsgi</span><span class="p">.</span><span class="n">service</span><span class="w"></span>
<span class="o">[</span><span class="n">Unit</span><span class="o">]</span><span class="w"></span>
<span class="n">Description</span><span class="o">=</span><span class="n">uWSGI</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">serve</span><span class="w"> </span><span class="n">MoinMoin</span><span class="w"></span>
<span class="k">After</span><span class="o">=</span><span class="n">syslog</span><span class="p">.</span><span class="n">target</span><span class="w"></span>


<span class="o">[</span><span class="n">Service</span><span class="o">]</span><span class="w"></span>
<span class="n">ExecStart</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">uwsgi</span><span class="w"> </span><span class="c1">--ini /usr/share/moin/uwsgi.ini</span>
<span class="n">RuntimeDirectory</span><span class="o">=</span><span class="n">uwsgi</span><span class="w"></span>
<span class="n">Restart</span><span class="o">=</span><span class="n">always</span><span class="w"></span>
<span class="n">KillSignal</span><span class="o">=</span><span class="n">SIGQUIT</span><span class="w"></span>
<span class="n">Type</span><span class="o">=</span><span class="n">notify</span><span class="w"></span>
<span class="n">StandardError</span><span class="o">=</span><span class="n">syslog</span><span class="w"></span>
<span class="n">NotifyAccess</span><span class="o">=</span><span class="ow">all</span><span class="w"></span>


<span class="o">[</span><span class="n">Install</span><span class="o">]</span><span class="w"></span>
<span class="n">WantedBy</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="k">user</span><span class="p">.</span><span class="n">target</span><span class="w"></span>
<span class="n">EOF</span><span class="w"></span>
</pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/journal.html">journal</a>
      <a href="./tag/blog.html">blog</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>    Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Walter Fan's Blog ",
  "url" : ".",
  "image": "./images/walterfan.jpg",
  "description": "an old programmer never die, he just branch to a new address."
}
</script>

</body>
</html>