
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="./theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">


  <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="./images/favicon.ico" type="image/x-icon">










 

<meta name="author" content="Walter Fan" />
<meta name="description" content="Daily minute" />
<meta name="keywords" content="journal, blog">


  <meta property="og:site_name" content="Walter Fan's Blog"/>
  <meta property="og:title" content="MDD for SRE"/>
  <meta property="og:description" content="Daily minute"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./mdd-for-sre.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2025-08-24 20:20:00+08:00"/>
  <meta property="article:modified_time" content="2025-08-24 22:30:00+08:00"/>
  <meta property="article:author" content="./author/walter-fan.html">
  <meta property="article:section" content="Journal"/>
  <meta property="article:tag" content="journal"/>
  <meta property="article:tag" content="blog"/>
  <meta property="og:image" content="./images/walterfan.jpg">

  <title>Walter Fan's Blog &ndash; MDD for SRE</title>


</head>
<body class="light-theme">

<aside>
  <div>
    <a href="./">
      <img src="./images/walterfan.jpg" alt="Walter Fan" title="Walter Fan">
    </a>

    <h1>
      <a href="./">Walter Fan</a>
    </h1>

    <p>手握灵珠常奋笔, 心开天籁不吹箫</p>


    <nav>
      <ul class="list">



          <li>
            <a target="_self" href="tao.html" >tao</a>
          </li>
          <li>
            <a target="_self" href="interest.html" >interest</a>
          </li>
          <li>
            <a target="_self" href="/wordpress" >notebook</a>
          </li>
          <li>
            <a target="_self" href="bookmark.html" >bookmark</a>
          </li>
          <li>
            <a target="_self" href="/webrtc/examples/index.html" >webrtc</a>
          </li>
          <li>
            <a target="_self" href="https://github.com/walterfan" >github</a>
          </li>
          <li>
            <a target="_self" href="https://www.jianshu.com/u/e0b365801f48" >技术文章</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="http://github.com/walterfan"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="mdd-for-sre">MDD for SRE</h1>
    <p>
      Posted on Sun 24 August 2025 in <a href="./category/journal.html">Journal</a>

    </p>
  </header>


  <div>
    <table>
<thead>
<tr>
<th><strong>Abstract</strong></th>
<th>MDD for SRE</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Authors</strong></td>
<td><a href="https://www.fanyamin.com">Walter Fan</a></td>
</tr>
<tr>
<td><strong>Category</strong></td>
<td>learning note</td>
</tr>
<tr>
<td><strong>Status</strong></td>
<td>v1.0</td>
</tr>
<tr>
<td><strong>Updated</strong></td>
<td>2025-08-24</td>
</tr>
<tr>
<td><strong>License</strong></td>
<td><a href="http://creativecommons.org/licenses/by-nc-nd/4.0">CC-BY-NC-ND 4.0</a></td>
</tr>
</tbody>
</table>
<h1 id="mdd-for-sre">MDD for SRE</h1>
<blockquote>
<blockquote>
<p>when you got through the storm, you won't be the same person who walked through it.
<em>当你穿过风暴走出来时，你已经不是走进去的那个人了。</em><br>
—— 致每一个被线上事故洗礼过的 SRE</p>
</blockquote>
</blockquote>
<h2 id="mdd">一、MDD 是什么鬼？</h2>
<p>度量驱动开发（Metrics Driven Development，MDD）听起来很学术，其实核心思想一句话就能概括： <strong>别拍脑袋做决策，用数据说话。</strong></p>
<p>在 SRE 体系里，MDD 就像一台“系统健康检测仪”，把模糊的“系统要稳”翻译成具体的指标：吞吐量、延迟、错误率……让我们从“感觉差不多”升级到“数据有证据”。换句话说，MDD 就是从“玄学经验”走向“量化科学”。</p>
<h2 id="slislosla">二、三大法宝：SLI、SLO、SLA</h2>
<p>要想把系统运营好，少不了这三兄弟：</p>
<ul>
<li>
<p><strong>SLI（Service Level Indicator）</strong>：系统健康的“体温计”。<br>
  吞吐量、响应时间、错误率，这些指标就是你系统的血压心跳。  </p>
</li>
<li>
<p><strong>SLO（Service Level Objective）</strong>：系统的“健身目标”。<br>
  例如：请求成功率 ≥ 99.9%，平均响应时间 ≤ 500ms。<br>
  SLO 不仅帮团队设定方向，还能防止产品经理天天嚷嚷“要 100% 可用”。  </p>
</li>
<li>
<p><strong>SLA（Service Level Agreement）</strong>：法律背书 + 赔偿承诺。<br>
  就是把 SLO 写进合同：没达标？赔钱！SLA 是系统可靠性与客户信任之间的“法律护城河”。  </p>
</li>
</ul>
<p>一句话总结：<br>
SLI 告诉你“我现在健康吗”，SLO 告诉你“我要多健康”，SLA 告诉客户“我保证健康，不然我掏钱”。</p>
<h2 id="mdd_1">三、MDD 的开发周期：数据先行，不再救火</h2>
<ul>
<li><strong>设计阶段</strong>：需求评审不只聊功能，还要把可靠性指标写进文档。就像写代码要有单测，设计方案也要有“可测性”。  </li>
<li><strong>开发阶段</strong>：写代码时就埋好监控点，用自动化测试和监控平台保证指标不跑偏。  </li>
<li><strong>运维阶段</strong>：实时监控 + 智能告警 + 自动化回滚。别等线上炸了再喊“谁来救火”，而是提前用数据发现隐患。  </li>
</ul>
<p>一句话，MDD 让 SRE 从“消防员”变成“城市规划师”。</p>
<h2 id="_1">四、最佳实践：少而精，别乱堆指标</h2>
<ul>
<li><strong>业务对齐</strong>：指标必须和业务挂钩，比如 API 延迟要能体现用户体验，而不是只看 CPU 飙到 90%。  </li>
<li><strong>最小完备</strong>：指标不要贪多，核心指标 3～5 个就能反映全局。指标一多，大家就会陷入“监控眼花症”。  </li>
<li><strong>动态演进</strong>：随着业务迭代，指标体系也要升级，别让老旧指标绑架了新系统。  </li>
</ul>
<p>此外，团队文化和工具链也很重要：<br>
度量评审会议要定期开，监控平台要整合好，别让指标散落在 10 个系统里，最后没人能拼出全貌。</p>
<h2 id="go">五、Go 微服务的实践：用代码把指标钉死</h2>
<p>拿一个 Go 订单服务举例，核心套路就是：<br>
1. <strong>埋点</strong>（用 OpenTelemetry / Prometheus）<br>
2. <strong>设目标</strong>（SLO + 错误预算）<br>
3. <strong>签契约</strong>（SLA）<br>
4. <strong>自动化响应</strong>（触发回滚 / 扩缩容）</p>
<p>代码示例：<br>
```go
// 定义请求计数器
var requestCounter = metric.Must(metric.NewInt64Counter(
   "order_service_request_count",
   metric.WithDescription("Total number of requests"),
))</p>
<p>// 在 HTTP 中间件中埋点
func metricsMiddleware(next http.Handler) http.Handler {
   return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
       requestCounter.Add(r.Context(), 1, metric.WithAttributes(
           attribute.String("method", r.Method),
           attribute.String("path", r.URL.Path),
       ))
       next.ServeHTTP(w, r)
   })
}
````</p>
<p>之后配合 Prometheus 写几个公式，就能把吞吐量、错误率、延迟一网打尽。</p>
<p>顺带一提：</p>
<ul>
<li>错误预算超了？自动触发回滚（ArgoCD 蓝绿部署）。</li>
<li>CPU 连续高于 80%？HPA 自动加 Pod。</li>
<li>想查慢请求？Jaeger 一键 Trace 到 SQL。</li>
</ul>
<p>这才是真·全链路闭环。</p>
<h2 id="_2">六、运维的收益：从“救火队”到“架构师”</h2>
<ul>
<li><strong>故障处理效率</strong>：MTTR 从 20 分钟缩短到 5 分钟。再也不是“凌晨两点 VPN 登录排查日志”的悲惨故事。</li>
<li><strong>日常监控成本降低</strong>：监控报表自动生成，日志和指标联动，SRE 不用盯着 Grafana 大屏熬夜。</li>
<li><strong>角色转型</strong>：运维不再只是“修电脑的”，而是系统可靠性的设计者，提前参与架构评审，和开发并肩作战。</li>
</ul>
<h2 id="_3">七、挑战与解法</h2>
<ul>
<li><strong>指标采集开销大</strong>：频繁采集可能拖慢系统 → 调整采样频率，用 summary 替代 histogram。</li>
<li><strong>跨服务链路难分析</strong>：微服务一多，指标像散沙 → 强制引入 <code>X-Request-ID</code>，用 Trace 串起来。</li>
</ul>
<h2 id="mdd-aiops">八、未来展望：MDD + AIOps</h2>
<p>未来，随着 AIOps 的发展，MDD 还可能升级成“智能度量驱动”：</p>
<ul>
<li>自动发现关键指标（AI 告诉你：原来用户流失和这个指标挂钩）。</li>
<li>智能扩缩容（AI 提前两小时预测流量高峰，Pod 已经扩好）。</li>
</ul>
<p>换句话说：
👉 未来的 SRE 可能不用天天盯监控，AI 会变成你贴心的“可靠性副驾驶”。</p>
<h2 id="_4">九、结语</h2>
<p>MDD 不只是一个“高大上”的概念，而是 SRE 的生存之道。
在 Go 微服务的场景下，它帮助我们从“上线即祈祷”进化为“上线即有数”。</p>
<p>记住一句话：
<strong>可靠性不是救火救出来的，而是用度量设计出来的。</strong></p>
<hr>
<p>本作品采用 <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a> 进行许可。</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/journal.html">journal</a>
      <a href="./tag/blog.html">blog</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="./ending-tls-client-authentication-certificate.html" title="Ending TLS Client Authentication Certificate">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="./ending-tls-client-authentication-certificate.html">Ending TLS Client Authentication Certificate</a></li>
      <li><a href="./how-to-learn-rust-in-7-days.html">how to learn rust in 7 days</a></li>
      <li><a href="./chatgptdu-zhi-dao-wo-men-huan-yao-du-shu-xie-shu-ma.html">chatgpt都知道, 我们还要读书写书吗</a></li>
      <li><a href="./cheng-xu-yuan-ba-ba-xie-gei-nu-er-de-qi-feng-xin.html">程序员爸爸写给女儿的七封信</a></li>
      <li><a href="./ru-he-ying-dui-yi-tuan-luan-ma.html">如何应对一团乱码</a></li>
    </ul>
  </div>



<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'wfblog';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

<footer>
<p>&copy; 2010 ~ 2030  Walter Fan <a href="https://beian.miit.gov.cn" target="_blank">皖ICP备20001876号-1</a></p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><!-- StatusCake -->

<!-- End StatusCake --></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Walter Fan's Blog ",
  "url" : ".",
  "image": "./images/walterfan.jpg",
  "description": "an old programmer never die, he just branch to a new address."
}
</script>
</body>
</html>